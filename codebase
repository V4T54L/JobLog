{
  "Dockerfile": "# Stage 1: Build the Go application\nFROM golang:1.21-alpine AS builder\n\nWORKDIR /app\n\n# Copy go.mod and go.sum to download dependencies\nCOPY go.mod go.sum ./\nRUN go mod download\n\n# Copy the rest of the application source code\nCOPY . .\n\n# Build the application\n# -ldflags=\"-w -s\" strips debug information, reducing binary size\nRUN CGO_ENABLED=0 GOOS=linux go build -ldflags=\"-w -s\" -o /job-app-tracker ./cmd/server\n\n# Stage 2: Create the final, minimal image\nFROM alpine:latest\n\nWORKDIR /app\n\n# Copy the static frontend assets\nCOPY --from=builder /app/client ./client\n\n# Copy the built binary from the builder stage\nCOPY --from=builder /job-app-tracker .\n\n# Expose the port the application will run on\nEXPOSE 8080\n\n# Command to run the executable\nCMD [\"./job-app-tracker\"]\n",
  "client/index.html": "\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"UTF-8\"\u003e\n    \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e\n    \u003ctitle\u003eJob App Tracker\u003c/title\u003e\n    \u003c!-- Tailwind CSS CDN --\u003e\n    \u003cscript src=\"https://cdn.tailwindcss.com\"\u003e\u003c/script\u003e\n    \u003cscript\u003e\n        // Basic Tailwind dark mode config\n        tailwind.config = {\n            darkMode: 'class',\n        }\n    \u003c/script\u003e\n\u003c/head\u003e\n\u003cbody class=\"bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300\"\u003e\n    \u003cdiv id=\"app\" class=\"min-h-screen flex flex-col\"\u003e\n        \u003c!-- App content will be rendered here by JavaScript --\u003e\n    \u003c/div\u003e\n\n    \u003cscript type=\"module\" src=\"/js/main.js\"\u003e\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n",
  "client/js/components/Navbar.js": "import { getTheme, toggleTheme } from '../state/themeState.js';\nimport { isLoggedIn, logout, subscribe } from '../state/authState.js';\nimport { navigate } from '../router.js';\n\nexport const Navbar = () =\u003e {\n    const nav = document.createElement('nav');\n    nav.className = 'bg-white dark:bg-gray-800 shadow p-4 flex justify-between items-center';\n\n    const render = () =\u003e {\n        const currentTheme = getTheme();\n        const loggedIn = isLoggedIn();\n\n        nav.innerHTML = `\n            \u003cdiv class=\"text-xl font-bold text-gray-800 dark:text-white\"\u003e\n                \u003ca href=\"/\" data-link\u003eJob Tracker\u003c/a\u003e\n            \u003c/div\u003e\n            \u003cdiv class=\"flex items-center space-x-4\"\u003e\n                \u003ca href=\"/dashboard\" data-link class=\"text-gray-600 dark:text-gray-300 hover:text-blue-500\"\u003eDashboard\u003c/a\u003e\n                \u003ca href=\"/applications\" data-link class=\"text-gray-600 dark:text-gray-300 hover:text-blue-500\"\u003eApplications\u003c/a\u003e\n                \u003ca href=\"/blog\" data-link class=\"text-gray-600 dark:text-gray-300 hover:text-blue-500\"\u003eBlog\u003c/a\u003e\n                ${loggedIn ? `\n                    \u003cbutton id=\"logout-btn\" class=\"text-gray-600 dark:text-gray-300 hover:text-blue-500\"\u003eLogout\u003c/button\u003e\n                ` : `\n                    \u003ca href=\"/login\" data-link class=\"text-gray-600 dark:text-gray-300 hover:text-blue-500\"\u003eLogin\u003c/a\u003e\n                    \u003ca href=\"/register\" data-link class=\"bg-blue-600 text-white px-3 py-1 rounded-md hover:bg-blue-700\"\u003eRegister\u003c/a\u003e\n                `}\n                \u003cbutton id=\"theme-switcher\" class=\"p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500\"\u003e\n                    \u003cspan class=\"theme-icon\"\u003e${currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô'}\u003c/span\u003e\n                \u003c/button\u003e\n            \u003c/div\u003e\n        `;\n\n        nav.querySelector('#theme-switcher').addEventListener('click', () =\u003e {\n            toggleTheme();\n            render(); // Re-render to update the icon\n        });\n\n        if (loggedIn) {\n            nav.querySelector('#logout-btn').addEventListener('click', () =\u003e {\n                logout();\n                navigate('/login');\n            });\n        }\n    };\n\n    subscribe(render); // Re-render whenever auth state changes\n    render(); // Initial render\n    return nav;\n};\n",
  "client/js/main.js": "import { initializeRouter, handleRoute } from './router.js';\nimport { initializeTheme } from './state/themeState.js';\nimport { Navbar } from './components/Navbar.js';\n\nconst appContainer = document.getElementById('app');\n\nfunction renderLayout() {\n    appContainer.innerHTML = ''; // Clear previous content\n    const navbar = Navbar();\n    const mainContent = document.createElement('main');\n    mainContent.id = 'main-content';\n    mainContent.className = 'flex-grow container mx-auto p-4';\n\n    appContainer.appendChild(navbar);\n    appContainer.appendChild(mainContent);\n    return mainContent;\n}\n\ndocument.addEventListener('DOMContentLoaded', () =\u003e {\n    initializeTheme();\n    const mainContentContainer = renderLayout();\n    initializeRouter(mainContentContainer);\n    handleRoute();\n});",
  "client/js/router.js": "import { HomeView } from './views/HomeView.js';\nimport { DashboardView } from './views/DashboardView.js';\nimport { LoginView } from './views/auth/LoginView.js';\nimport { RegisterView } from './views/auth/RegisterView.js';\n\nlet mainContentContainer;\n\nconst routes = {\n    '/': HomeView,\n    '/dashboard': DashboardView,\n    '/login': LoginView,\n    '/register': RegisterView,\n};\n\nconst navigate = (path) =\u003e {\n    window.history.pushState({}, path, window.location.origin + path);\n    handleRoute();\n};\n\nconst handleRoute = () =\u003e {\n    const path = window.location.pathname;\n    const view = routes[path] || { render: (container) =\u003e container.innerHTML = '\u003ch1\u003e404 Not Found\u003c/h1\u003e' };\n    if (mainContentContainer) {\n        view.render(mainContentContainer);\n    }\n};\n\nconst initializeRouter = (container) =\u003e {\n    mainContentContainer = container;\n    window.addEventListener('popstate', handleRoute);\n    document.body.addEventListener('click', e =\u003e {\n        if (e.target.matches('[data-link]')) {\n            e.preventDefault();\n            navigate(e.target.getAttribute('href'));\n        }\n    });\n};\n\nexport { initializeRouter, handleRoute, navigate };\n",
  "client/js/services/authService.js": "const API_BASE_URL = '/api';\n\nasync function handleResponse(response) {\n    if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || `HTTP error! status: ${response.status}`);\n    }\n    return response.json();\n}\n\nexport const AuthService = {\n    login: async (email, password) =\u003e {\n        const response = await fetch(`${API_BASE_URL}/auth/login`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ email, password })\n        });\n        return handleResponse(response);\n    },\n\n    register: async (username, email, password) =\u003e {\n        const response = await fetch(`${API_BASE_URL}/auth/register`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ username, email, password })\n        });\n        return handleResponse(response);\n    },\n};\n",
  "client/js/state/authState.js": "let token = localStorage.getItem('jwt_token');\nlet user = null; // In a real app, you might fetch user details and store them here\n\nconst subscribers = new Set();\n\nconst notify = () =\u003e {\n    subscribers.forEach(callback =\u003e callback());\n};\n\nexport const setToken = (newToken) =\u003e {\n    token = newToken;\n    if (newToken) {\n        localStorage.setItem('jwt_token', newToken);\n    } else {\n        localStorage.removeItem('jwt_token');\n    }\n    notify();\n};\n\nexport const getToken = () =\u003e {\n    return token;\n};\n\nexport const isLoggedIn = () =\u003e {\n    return !!token;\n};\n\nexport const logout = () =\u003e {\n    setToken(null);\n};\n\nexport const subscribe = (callback) =\u003e {\n    subscribers.add(callback);\n    return () =\u003e subscribers.delete(callback); // Unsubscribe function\n};\n",
  "client/js/state/themeState.js": "let currentTheme = localStorage.getItem('theme') || 'light';\n\nconst applyTheme = (theme) =\u003e {\n    if (theme === 'dark') {\n        document.documentElement.classList.add('dark');\n    } else {\n        document.documentElement.classList.remove('dark');\n    }\n};\n\nexport const getTheme = () =\u003e currentTheme;\n\nexport const toggleTheme = () =\u003e {\n    currentTheme = currentTheme === 'light' ? 'dark' : 'light';\n    localStorage.setItem('theme', currentTheme);\n    applyTheme(currentTheme);\n    return currentTheme;\n};\n\nexport const initializeTheme = () =\u003e {\n    applyTheme(currentTheme);\n};\n",
  "client/js/views/DashboardView.js": "export const DashboardView = {\n    render: (container) =\u003e {\n        container.innerHTML = `\n            \u003cdiv\u003e\n                \u003ch1 class=\"text-3xl font-bold mb-6\"\u003eDashboard\u003c/h1\u003e\n                \u003cdiv class=\"p-6 bg-white dark:bg-gray-800 rounded-lg shadow\"\u003e\n                    \u003cp\u003eAnalytics and charts will be displayed here.\u003c/p\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n        `;\n    }\n};\n```",
  "client/js/views/HomeView.js": "export const HomeView = {\n    render: (container) =\u003e {\n        container.innerHTML = `\n            \u003cdiv class=\"text-center py-16\"\u003e\n                \u003ch1 class=\"text-4xl font-bold mb-4\"\u003eWelcome to Job App Tracker\u003c/h1\u003e\n                \u003cp class=\"text-lg text-gray-600 dark:text-gray-400\"\u003eYour personal dashboard for managing job applications.\u003c/p\u003e\n            \u003c/div\u003e\n        `;\n    }\n};\n",
  "client/js/views/auth/LoginView.js": "import { AuthService } from '../../services/authService.js';\nimport { setToken } from '../../state/authState.js';\nimport { navigate } from '../../router.js';\n\nexport const LoginView = {\n    render: (container) =\u003e {\n        container.innerHTML = `\n            \u003cdiv class=\"max-w-md mx-auto mt-10 p-8 border rounded-lg shadow-lg bg-white dark:bg-gray-800\"\u003e\n                \u003ch2 class=\"text-2xl font-bold mb-6 text-center\"\u003eLogin\u003c/h2\u003e\n                \u003cform id=\"login-form\"\u003e\n                    \u003cdiv id=\"error-message\" class=\"hidden text-red-500 mb-4 p-2 bg-red-100 dark:bg-red-900 rounded\"\u003e\u003c/div\u003e\n                    \u003cdiv class=\"mb-4\"\u003e\n                        \u003clabel for=\"email\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003eEmail\u003c/label\u003e\n                        \u003cinput type=\"email\" id=\"email\" name=\"email\" required class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600\"\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\"mb-6\"\u003e\n                        \u003clabel for=\"password\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003ePassword\u003c/label\u003e\n                        \u003cinput type=\"password\" id=\"password\" name=\"password\" required class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600\"\u003e\n                    \u003c/div\u003e\n                    \u003cbutton type=\"submit\" class=\"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\u003e\n                        Login\n                    \u003c/button\u003e\n                \u003c/form\u003e\n                \u003cp class=\"mt-4 text-center text-sm\"\u003e\n                    Don't have an account? \u003ca href=\"/register\" data-link class=\"text-blue-500 hover:underline\"\u003eRegister here\u003c/a\u003e.\n                \u003c/p\u003e\n            \u003c/div\u003e\n        `;\n\n        const form = container.querySelector('#login-form');\n        const errorMessage = container.querySelector('#error-message');\n        form.addEventListener('submit', async (e) =\u003e {\n            e.preventDefault();\n            errorMessage.classList.add('hidden');\n            const email = form.email.value;\n            const password = form.password.value;\n\n            try {\n                const data = await AuthService.login(email, password);\n                setToken(data.token);\n                navigate('/dashboard');\n            } catch (error) {\n                errorMessage.textContent = error.message;\n                errorMessage.classList.remove('hidden');\n            }\n        });\n    }\n};\n",
  "client/js/views/auth/RegisterView.js": "import { AuthService } from '../../services/authService.js';\nimport { navigate } from '../../router.js';\n\nexport const RegisterView = {\n    render: (container) =\u003e {\n        container.innerHTML = `\n            \u003cdiv class=\"max-w-md mx-auto mt-10 p-8 border rounded-lg shadow-lg bg-white dark:bg-gray-800\"\u003e\n                \u003ch2 class=\"text-2xl font-bold mb-6 text-center\"\u003eRegister\u003c/h2\u003e\n                \u003cform id=\"register-form\"\u003e\n                    \u003cdiv id=\"error-message\" class=\"hidden text-red-500 mb-4 p-2 bg-red-100 dark:bg-red-900 rounded\"\u003e\u003c/div\u003e\n                    \u003cdiv class=\"mb-4\"\u003e\n                        \u003clabel for=\"username\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003eUsername\u003c/label\u003e\n                        \u003cinput type=\"text\" id=\"username\" name=\"username\" required class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600\"\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\"mb-4\"\u003e\n                        \u003clabel for=\"email\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003eEmail\u003c/label\u003e\n                        \u003cinput type=\"email\" id=\"email\" name=\"email\" required class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600\"\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\"mb-6\"\u003e\n                        \u003clabel for=\"password\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003ePassword\u003c/label\u003e\n                        \u003cinput type=\"password\" id=\"password\" name=\"password\" required class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600\"\u003e\n                    \u003c/div\u003e\n                    \u003cbutton type=\"submit\" class=\"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\u003e\n                        Register\n                    \u003c/button\u003e\n                \u003c/form\u003e\n                 \u003cp class=\"mt-4 text-center text-sm\"\u003e\n                    Already have an account? \u003ca href=\"/login\" data-link class=\"text-blue-500 hover:underline\"\u003eLogin here\u003c/a\u003e.\n                \u003c/p\u003e\n            \u003c/div\u003e\n        `;\n\n        const form = container.querySelector('#register-form');\n        const errorMessage = container.querySelector('#error-message');\n        form.addEventListener('submit', async (e) =\u003e {\n            e.preventDefault();\n            errorMessage.classList.add('hidden');\n            const username = form.username.value;\n            const email = form.email.value;\n            const password = form.password.value;\n\n            try {\n                await AuthService.register(username, email, password);\n                navigate('/login'); // Redirect to login after successful registration\n            } catch (error) {\n                errorMessage.textContent = error.message;\n                errorMessage.classList.remove('hidden');\n            }\n        });\n    }\n};\n",
  "cmd/server/main.go": "package main\n\nimport (\n\t\"database/sql\"\n\t\"fmt\"\n\t\"job-app-tracker/internal/handler\"\n\t\"job-app-tracker/internal/repository/postgres\"\n\t\"job-app-tracker/internal/usecase\"\n\t\"log\"\n\t\"os\"\n\n\t\"github.com/golang-migrate/migrate/v4\"\n\t_ \"github.com/golang-migrate/migrate/v4/database/postgres\"\n\t_ \"github.com/golang-migrate/migrate/v4/source/file\"\n\t\"github.com/jmoiron/sqlx\"\n\t_ \"github.com/joho/godotenv/autoload\" // Load .env file automatically\n\t_ \"github.com/lib/pq\"\n)\n\nfunc main() {\n\t// --- Database Connection ---\n\tdbURL := os.Getenv(\"DATABASE_URL\")\n\tif dbURL == \"\" {\n\t\tdbURL = \"postgres://user:password@localhost:5432/job_tracker_db?sslmode=disable\"\n\t}\n\n\t// Run Migrations\n\trunMigrations(dbURL)\n\n\t// Connect to DB with sqlx\n\tdb, err := sqlx.Connect(\"postgres\", dbURL)\n\tif err != nil {\n\t\tlog.Fatalf(\"Could not connect to the database: %v\", err)\n\t}\n\tdefer db.Close()\n\n\t// --- Dependency Injection ---\n\tuserRepo := postgres.NewPostgresUserRepository(db)\n\tuserUseCase := usecase.NewUserService(userRepo)\n\n\t// --- Router Setup ---\n\trouter := handler.NewRouter(userUseCase)\n\n\t// --- Start Server ---\n\tport := os.Getenv(\"PORT\")\n\tif port == \"\" {\n\t\tport = \"8080\"\n\t}\n\tlog.Printf(\"Server starting on port %s\", port)\n\tif err := router.Start(\":\" + port); err != nil {\n\t\tlog.Fatalf(\"Failed to start server: %v\", err)\n\t}\n}\n\nfunc runMigrations(databaseURL string) {\n\tmigrationPath := \"file://migrations\"\n\tm, err := migrate.New(migrationPath, databaseURL)\n\tif err != nil {\n\t\tlog.Fatalf(\"Could not create migrate instance: %v\", err)\n\t}\n\n\tif err := m.Up(); err != nil \u0026\u0026 err != migrate.ErrNoChange {\n\t\tlog.Fatalf(\"Could not apply migrations: %v\", err)\n\t}\n\n\tfmt.Println(\"Migrations applied successfully\")\n}\n",
  "go.mod": "module job-app-tracker\n\ngo 1.21\n\nrequire (\n\tgithub.com/golang-jwt/jwt/v5 v5.2.1\n\tgithub.com/golang-migrate/migrate/v4 v4.17.1\n\tgithub.com/jackc/pgx/v5 v5.6.0\n\tgithub.com/jmoiron/sqlx v1.4.0\n\tgithub.com/joho/godotenv v1.5.1\n\tgithub.com/labstack/echo/v4 v4.12.0\n\tgolang.org/x/crypto v0.22.0\n)\n\nrequire (\n\tgithub.com/golang-jwt/jwt v3.2.2+incompatible // indirect\n\tgithub.com/hashicorp/errwrap v1.1.0 // indirect\n\tgithub.com/hashicorp/go-multierror v1.1.1 // indirect\n\tgithub.com/jackc/pgpassfile v1.0.0 // indirect\n\tgithub.com/jackc/pgservicefile v0.0.0-20221227161230-091c0ba34f0a // indirect\n\tgithub.com/jackc/puddle/v2 v2.2.1 // indirect\n\tgithub.com/labstack/gommon v0.4.2 // indirect\n\tgithub.com/lib/pq v1.10.9 // indirect\n\tgithub.com/mattn/go-colorable v0.1.13 // indirect\n\tgithub.com/mattn/go-isatty v0.0.20 // indirect\n\tgithub.com/valyala/bytebufferpool v1.0.0 // indirect\n\tgithub.com/valyala/fasttemplate v1.2.2 // indirect\n\tgo.uber.org/atomic v1.7.0 // indirect\n\tgolang.org/x/net v0.24.0 // indirect\n\tgolang.org/x/sync v0.1.0 // indirect\n\tgolang.org/x/sys v0.19.0 // indirect\n\tgolang.org/x/text v0.14.0 // indirect\n\tgolang.org/x/time v0.5.0 // indirect\n)\n",
  "internal/domain/application.go": "package domain\n\nimport (\n\t\"database/sql\"\n\t\"encoding/json\"\n\t\"time\"\n)\n\ntype Company struct {\n\tID             int64\n\tName           string\n\tNormalizedName string\n\tMetadata       json.RawMessage // JSON or JSONB\n}\n\ntype Role struct {\n\tID        int64\n\tCompanyID int64\n\tTitle     string\n\tMetadata  json.RawMessage // JSON or JSONB\n}\n\ntype Application struct {\n\tID            int64\n\tUserID        int64\n\tCompanyID     int64\n\tRoleID        int64\n\tDateApplied   time.Time\n\tStatus        string\n\tMetadata      json.RawMessage // JSON or JSONB\n\tCurrentNoteID sql.NullInt64\n}\n\ntype ApplicationNote struct {\n\tID            int64\n\tApplicationID int64\n\tUserID        int64\n\tTimestamp     time.Time\n\tContent       string\n}\n",
  "internal/domain/blog.go": "package domain\n\nimport (\n\t\"database/sql\"\n\t\"time\"\n)\n\ntype BlogPost struct {\n\tID                 int64\n\tUserID             int64\n\tTitle              string\n\tSlug               string\n\tContentMD          string\n\tContentHTML        string\n\tExcerpt            string\n\tIsPublic           bool\n\tCreatedAt          time.Time\n\tUpdatedAt          time.Time\n\tSEOMetaTitle       sql.NullString\n\tSEOMetaDescription sql.NullString\n\tTags               []string // Assuming tags are stored in a way that can be scanned into a slice, e.g., text[] in PostgreSQL\n}\n\ntype DraftVersion struct {\n\tID                 int64\n\tPostID             sql.NullInt64 // Null for brand new drafts\n\tUserID             int64\n\tContentMD          string\n\tContentHTML        string\n\tLastSavedAt        time.Time\n\tIsPublishedVersion bool\n}\n",
  "internal/domain/social.go": "package domain\n\nimport (\n\t\"time\"\n)\n\ntype ContentType string\n\nconst (\n\tContentTypePost    ContentType = \"post\"\n\tContentTypeComment ContentType = \"comment\"\n)\n\ntype Comment struct {\n\tID              int64\n\tPostID          int64\n\tUserID          int64\n\tParentCommentID int64 // Use 0 or a specific value for top-level comments if nullable is complex\n\tContentMD       string\n\tContentHTML     string\n\tCreatedAt       time.Time\n\tUpdatedAt       time.Time\n\tDepthLevel      int\n}\n\ntype Like struct {\n\tID          int64\n\tUserID      int64\n\tContentType ContentType\n\tContentID   int64\n}\n\ntype Follow struct {\n\tID             int64\n\tFollowerUserID int64\n\tFolloweeUserID int64\n}\n",
  "internal/domain/user.go": "package domain\n\nimport (\n\t\"database/sql\"\n\t\"encoding/json\"\n\t\"time\"\n)\n\ntype User struct {\n\tID             int64           `db:\"id\"`\n\tUsername       string          `db:\"username\"`\n\tEmail          string          `db:\"email\"`\n\tHashedPassword string          `db:\"hashed_password\"`\n\tBio            sql.NullString  `db:\"bio\"`\n\tAvatarURL      sql.NullString  `db:\"avatar_url\"`\n\tSettings       json.RawMessage `db:\"settings\"`\n\tCreatedAt      time.Time       `db:\"created_at\"`\n\tUpdatedAt      time.Time       `db:\"updated_at\"`\n}\n",
  "internal/handler/auth_handler.go": "package handler\n\nimport (\n\t\"job-app-tracker/internal/usecase\"\n\t\"net/http\"\n\n\t\"github.com/labstack/echo/v4\"\n)\n\ntype AuthHandler struct {\n\tuserUseCase usecase.UserUseCase\n}\n\nfunc NewAuthHandler(uc usecase.UserUseCase) *AuthHandler {\n\treturn \u0026AuthHandler{userUseCase: uc}\n}\n\ntype RegisterRequest struct {\n\tUsername string `json:\"username\"`\n\tEmail    string `json:\"email\"`\n\tPassword string `json:\"password\"`\n}\n\ntype LoginRequest struct {\n\tEmail    string `json:\"email\"`\n\tPassword string `json:\"password\"`\n}\n\nfunc (h *AuthHandler) Register(c echo.Context) error {\n\tvar req RegisterRequest\n\tif err := c.Bind(\u0026req); err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"error\": \"Invalid request payload\"})\n\t}\n\n\tuser, err := h.userUseCase.Register(req.Username, req.Email, req.Password)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusConflict, map[string]string{\"error\": err.Error()})\n\t}\n\n\t// Don't send password back\n\tuser.HashedPassword = \"\"\n\n\treturn c.JSON(http.StatusCreated, user)\n}\n\nfunc (h *AuthHandler) Login(c echo.Context) error {\n\tvar req LoginRequest\n\tif err := c.Bind(\u0026req); err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"error\": \"Invalid request payload\"})\n\t}\n\n\ttoken, err := h.userUseCase.Login(req.Email, req.Password)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusUnauthorized, map[string]string{\"error\": \"Invalid credentials\"})\n\t}\n\n\treturn c.JSON(http.StatusOK, map[string]string{\"token\": token})\n}\n",
  "internal/handler/middleware.go": "package handler\n\nimport (\n\t\"job-app-tracker/pkg/util\"\n\t\"net/http\"\n\t\"strings\"\n\n\t\"github.com/labstack/echo/v4\"\n)\n\nfunc AuthMiddleware(next echo.HandlerFunc) echo.HandlerFunc {\n\treturn func(c echo.Context) error {\n\t\tauthHeader := c.Request().Header.Get(\"Authorization\")\n\t\tif authHeader == \"\" {\n\t\t\treturn c.JSON(http.StatusUnauthorized, map[string]string{\"error\": \"Missing authorization header\"})\n\t\t}\n\n\t\tparts := strings.Split(authHeader, \" \")\n\t\tif len(parts) != 2 || strings.ToLower(parts[0]) != \"bearer\" {\n\t\t\treturn c.JSON(http.StatusUnauthorized, map[string]string{\"error\": \"Invalid authorization header format\"})\n\t\t}\n\n\t\ttokenStr := parts[1]\n\t\tclaims, err := util.ValidateJWT(tokenStr)\n\t\tif err != nil {\n\t\t\treturn c.JSON(http.StatusUnauthorized, map[string]string{\"error\": \"Invalid token\"})\n\t\t}\n\n\t\tc.Set(\"userID\", claims.UserID)\n\t\tc.Set(\"username\", claims.Username)\n\n\t\treturn next(c)\n\t}\n}\n",
  "internal/handler/router.go": "package handler\n\nimport (\n\t\"job-app-tracker/internal/usecase\"\n\t\"net/http\"\n\t\"os\"\n\t\"path/filepath\"\n\n\t\"github.com/labstack/echo/v4\"\n\t\"github.com/labstack/echo/v4/middleware\"\n)\n\nfunc spaHandler(staticPath, indexPath string) echo.HandlerFunc {\n\treturn func(c echo.Context) error {\n\t\tp := c.Request().URL.Path\n\t\t// Try to serve a static file\n\t\tfsPath := filepath.Join(staticPath, p)\n\t\tif _, err := os.Stat(fsPath); err == nil {\n\t\t\treturn c.File(fsPath)\n\t\t}\n\t\t// Fallback to index.html for SPA routing\n\t\treturn c.File(filepath.Join(staticPath, indexPath))\n\t}\n}\n\nfunc NewRouter(userUC usecase.UserUseCase) *echo.Echo {\n\te := echo.New()\n\n\t// Middleware\n\te.Use(middleware.Logger())\n\te.Use(middleware.Recover())\n\n\t// API routes\n\tapiGroup := e.Group(\"/api\")\n\t{\n\t\tauthHandler := NewAuthHandler(userUC)\n\t\tauthGroup := apiGroup.Group(\"/auth\")\n\t\t{\n\t\t\tauthGroup.POST(\"/register\", authHandler.Register)\n\t\t\tauthGroup.POST(\"/login\", authHandler.Login)\n\t\t}\n\n\t\t// Example of a protected route\n\t\tapiGroup.GET(\"/protected\", func(c echo.Context) error {\n\t\t\tuserID := c.Get(\"userID\").(int64)\n\t\t\treturn c.JSON(http.StatusOK, map[string]interface{}{\"message\": \"Welcome!\", \"user_id\": userID})\n\t\t}, AuthMiddleware)\n\t}\n\n\t// Serve SPA\n\te.GET(\"/*\", spaHandler(\"client\", \"index.html\"))\n\n\treturn e\n}\n",
  "internal/repository/interfaces.go": "package repository\n\nimport \"job-app-tracker/internal/domain\"\n\ntype UserRepository interface {\n\tCreate(user *domain.User) error\n\tGetByEmail(email string) (*domain.User, error)\n\tGetByUsername(username string) (*domain.User, error)\n\tGetByID(id int64) (*domain.User, error)\n}\n",
  "internal/repository/postgres/user_repository.go": "package postgres\n\nimport (\n\t\"database/sql\"\n\t\"job-app-tracker/internal/domain\"\n\t\"job-app-tracker/internal/repository\"\n\n\t\"github.com/jmoiron/sqlx\"\n)\n\ntype postgresUserRepository struct {\n\tdb *sqlx.DB\n}\n\nfunc NewPostgresUserRepository(db *sqlx.DB) repository.UserRepository {\n\treturn \u0026postgresUserRepository{db: db}\n}\n\nfunc (r *postgresUserRepository) Create(user *domain.User) error {\n\tquery := `INSERT INTO users (username, email, hashed_password) VALUES ($1, $2, $3) RETURNING id, created_at, updated_at`\n\treturn r.db.QueryRow(query, user.Username, user.Email, user.HashedPassword).Scan(\u0026user.ID, \u0026user.CreatedAt, \u0026user.UpdatedAt)\n}\n\nfunc (r *postgresUserRepository) GetByEmail(email string) (*domain.User, error) {\n\tvar user domain.User\n\tquery := `SELECT id, username, email, hashed_password, bio, avatar_url, settings, created_at, updated_at FROM users WHERE email = $1`\n\terr := r.db.Get(\u0026user, query, email)\n\tif err == sql.ErrNoRows {\n\t\treturn nil, nil // Not an error, just no user found\n\t}\n\treturn \u0026user, err\n}\n\nfunc (r *postgresUserRepository) GetByUsername(username string) (*domain.User, error) {\n\tvar user domain.User\n\tquery := `SELECT id, username, email, hashed_password, bio, avatar_url, settings, created_at, updated_at FROM users WHERE username = $1`\n\terr := r.db.Get(\u0026user, query, username)\n\tif err == sql.ErrNoRows {\n\t\treturn nil, nil // Not an error, just no user found\n\t}\n\treturn \u0026user, err\n}\n\nfunc (r *postgresUserRepository) GetByID(id int64) (*domain.User, error) {\n\tvar user domain.User\n\tquery := `SELECT id, username, email, hashed_password, bio, avatar_url, settings, created_at, updated_at FROM users WHERE id = $1`\n\terr := r.db.Get(\u0026user, query, id)\n\tif err == sql.ErrNoRows {\n\t\treturn nil, nil\n\t}\n\treturn \u0026user, err\n}\n",
  "internal/usecase/interfaces.go": "package usecase\n\nimport \"job-app-tracker/internal/domain\"\n\ntype UserUseCase interface {\n\tRegister(username, email, password string) (*domain.User, error)\n\tLogin(email, password string) (string, error) // Returns token\n}\n",
  "internal/usecase/user_service.go": "package usecase\n\nimport (\n\t\"errors\"\n\t\"job-app-tracker/internal/domain\"\n\t\"job-app-tracker/internal/repository\"\n\t\"job-app-tracker/pkg/util\"\n)\n\ntype userService struct {\n\tuserRepo repository.UserRepository\n}\n\nfunc NewUserService(userRepo repository.UserRepository) UserUseCase {\n\treturn \u0026userService{userRepo: userRepo}\n}\n\nfunc (s *userService) Register(username, email, password string) (*domain.User, error) {\n\t// Basic validation\n\tif username == \"\" || email == \"\" || password == \"\" {\n\t\treturn nil, errors.New(\"username, email, and password are required\")\n\t}\n\n\t// Check if user already exists\n\texistingUser, err := s.userRepo.GetByEmail(email)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\tif existingUser != nil {\n\t\treturn nil, errors.New(\"user with this email already exists\")\n\t}\n\n\texistingUser, err = s.userRepo.GetByUsername(username)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\tif existingUser != nil {\n\t\treturn nil, errors.New(\"username is already taken\")\n\t}\n\n\t// Hash password\n\thashedPassword, err := util.HashPassword(password)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\n\t// Create user\n\tuser := \u0026domain.User{\n\t\tUsername:       username,\n\t\tEmail:          email,\n\t\tHashedPassword: hashedPassword,\n\t}\n\n\tif err := s.userRepo.Create(user); err != nil {\n\t\treturn nil, err\n\t}\n\n\treturn user, nil\n}\n\nfunc (s *userService) Login(email, password string) (string, error) {\n\tuser, err := s.userRepo.GetByEmail(email)\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\tif user == nil {\n\t\treturn \"\", errors.New(\"invalid credentials\")\n\t}\n\n\tif !util.CheckPasswordHash(password, user.HashedPassword) {\n\t\treturn \"\", errors.New(\"invalid credentials\")\n\t}\n\n\ttoken, err := util.GenerateJWT(user.ID, user.Username)\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\n\treturn token, nil\n}\n",
  "migrations/000001_create_users_table.up.sql": "CREATE TABLE IF NOT EXISTS users (\n    id BIGSERIAL PRIMARY KEY,\n    username VARCHAR(50) UNIQUE NOT NULL,\n    email VARCHAR(255) UNIQUE NOT NULL,\n    hashed_password VARCHAR(255) NOT NULL,\n    bio TEXT,\n    avatar_url VARCHAR(255),\n    settings JSONB,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n",
  "pkg/util/hash.go": "package util\n\nimport \"golang.org/x/crypto/bcrypt\"\n\n// HashPassword generates a bcrypt hash of the password.\nfunc HashPassword(password string) (string, error) {\n\tbytes, err := bcrypt.GenerateFromPassword([]byte(password), 14)\n\treturn string(bytes), err\n}\n\n// CheckPasswordHash compares a password with its hash.\nfunc CheckPasswordHash(password, hash string) bool {\n\terr := bcrypt.CompareHashAndPassword([]byte(hash), []byte(password))\n\treturn err == nil\n}\n",
  "pkg/util/jwt.go": "package util\n\nimport (\n\t\"fmt\"\n\t\"time\"\n\n\t\"github.com/golang-jwt/jwt/v5\"\n)\n\nvar jwtSecret = []byte(\"a_very_secret_key_that_should_be_in_env\") // TODO: Move to config\n\ntype Claims struct {\n\tUserID   int64  `json:\"user_id\"`\n\tUsername string `json:\"username\"`\n\tjwt.RegisteredClaims\n}\n\nfunc GenerateJWT(userID int64, username string) (string, error) {\n\texpirationTime := time.Now().Add(24 * time.Hour)\n\tclaims := \u0026Claims{\n\t\tUserID:   userID,\n\t\tUsername: username,\n\t\tRegisteredClaims: jwt.RegisteredClaims{\n\t\t\tExpiresAt: jwt.NewNumericDate(expirationTime),\n\t\t},\n\t}\n\n\ttoken := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)\n\treturn token.SignedString(jwtSecret)\n}\n\nfunc ValidateJWT(tokenStr string) (*Claims, error) {\n\tclaims := \u0026Claims{}\n\ttoken, err := jwt.ParseWithClaims(tokenStr, claims, func(token *jwt.Token) (interface{}, error) {\n\t\treturn jwtSecret, nil\n\t})\n\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\n\tif !token.Valid {\n\t\treturn nil, fmt.Errorf(\"invalid token\")\n\t}\n\n\treturn claims, nil\n}\n"
}