{
  "Dockerfile": "# Stage 1: Build the Go application\nFROM golang:1.21-alpine AS builder\n\nWORKDIR /app\n\n# Copy go.mod and go.sum to download dependencies\nCOPY go.mod go.sum ./\nRUN go mod download\n\n# Copy the rest of the application source code\nCOPY . .\n\n# Build the application\n# -ldflags=\"-w -s\" strips debug information, reducing binary size\nRUN CGO_ENABLED=0 GOOS=linux go build -ldflags=\"-w -s\" -o /job-app-tracker ./cmd/server\n\n# Stage 2: Create the final, minimal image\nFROM alpine:latest\n\nWORKDIR /app\n\n# Copy the static frontend assets\nCOPY --from=builder /app/client ./client\n\n# Copy the built binary from the builder stage\nCOPY --from=builder /job-app-tracker .\n\n# Expose the port the application will run on\nEXPOSE 8080\n\n# Command to run the executable\nCMD [\"./job-app-tracker\"]\n",
  "client/index.html": "\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\" class=\"light\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"UTF-8\"\u003e\n    \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e\n    \u003ctitle\u003eJob App Tracker\u003c/title\u003e\n    \u003cscript src=\"https://cdn.tailwindcss.com\"\u003e\u003c/script\u003e\n    \u003cscript\u003e\n        tailwind.config = {\n            darkMode: 'class',\n            theme: {\n                extend: {\n                    typography: ({ theme }) =\u003e ({\n                        DEFAULT: {\n                            css: {\n                                a: {\n                                    color: theme('colors.blue.600'),\n                                    '\u0026:hover': {\n                                        color: theme('colors.blue.800'),\n                                    },\n                                },\n                            },\n                        },\n                        invert: {\n                             css: {\n                                a: {\n                                    color: theme('colors.blue.400'),\n                                    '\u0026:hover': {\n                                        color: theme('colors.blue.300'),\n                                    },\n                                },\n                            },\n                        }\n                    }),\n                }\n            },\n            plugins: [\n                require('@tailwindcss/typography'),\n                require('@tailwindcss/forms'),\n            ],\n        }\n    \u003c/script\u003e\n\u003c/head\u003e\n\u003cbody class=\"bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-200\"\u003e\n    \u003cdiv id=\"app\" class=\"min-h-screen flex flex-col\"\u003e\n        \u003c!-- Content will be rendered here by JavaScript --\u003e\n    \u003c/div\u003e\n\n    \u003c!-- Markdown Parser --\u003e\n    \u003cscript src=\"https://cdn.jsdelivr.net/npm/marked/marked.min.js\"\u003e\u003c/script\u003e\n    \u003cscript type=\"module\" src=\"/js/main.js\"\u003e\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n",
  "client/js/components/ApplicationCard.js": "export const ApplicationCard = (app) =\u003e {\n    const card = document.createElement('a');\n    card.href = `/applications/${app.ID}`;\n    card.setAttribute('data-link', '');\n    card.className = 'block bg-white dark:bg-gray-800 p-4 rounded-lg shadow hover:shadow-md transition-shadow duration-200';\n\n    const date = new Date(app.DateApplied).toLocaleDateString();\n\n    card.innerHTML = `\n        \u003cdiv class=\"flex justify-between items-start\"\u003e\n            \u003cdiv\u003e\n                \u003ch3 class=\"text-lg font-bold text-blue-600 dark:text-blue-400\"\u003e${app.RoleID}\u003c/h3\u003e\n                \u003cp class=\"text-gray-600 dark:text-gray-400\"\u003e${app.CompanyID}\u003c/p\u003e\n            \u003c/div\u003e\n            \u003cspan class=\"bg-blue-100 text-blue-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded dark:bg-blue-900 dark:text-blue-300\"\u003e${app.Status}\u003c/span\u003e\n        \u003c/div\u003e\n        \u003cp class=\"text-sm text-gray-500 dark:text-gray-400 mt-2\"\u003eApplied on: ${date}\u003c/p\u003e\n    `;\n    // TODO: Fetch and display actual company/role names instead of IDs\n    return card;\n};\n",
  "client/js/components/BlogPostCard.js": "export const BlogPostCard = (post) =\u003e {\n    const card = document.createElement('a');\n    card.href = `/blog/${post.username}/${post.slug}`;\n    card.setAttribute('data-link', '');\n    card.className = 'block bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200';\n\n    card.innerHTML = `\n        \u003ch2 class=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\"\u003e${post.title}\u003c/h2\u003e\n        \u003cp class=\"text-gray-600 dark:text-gray-400 mb-4\"\u003e${post.excerpt.String || ''}\u003c/p\u003e\n        \u003cdiv class=\"text-sm text-gray-500 dark:text-gray-400\"\u003e\n            \u003cspan\u003eBy ${post.username}\u003c/span\u003e \u0026middot;\n            \u003cspan\u003e${new Date(post.createdAt).toLocaleDateString()}\u003c/span\u003e\n        \u003c/div\u003e\n    `;\n    return card;\n};\n",
  "client/js/components/CommentItem.js": "import { BlogService } from '../services/blogService.js';\nimport { isLoggedIn } from '../state/authState.js';\n\nfunction createCommentForm(postId, parentCommentId, onCommentAdded) {\n    const form = document.createElement('form');\n    form.className = 'mt-2';\n    form.innerHTML = `\n        \u003ctextarea name=\"content_md\" class=\"w-full p-2 border rounded bg-gray-50 dark:bg-gray-700 dark:border-gray-600\" rows=\"2\" placeholder=\"Write a reply...\"\u003e\u003c/textarea\u003e\n        \u003cdiv class=\"flex justify-end mt-2\"\u003e\n            \u003cbutton type=\"submit\" class=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700\"\u003eReply\u003c/button\u003e\n        \u003c/div\u003e\n    `;\n\n    form.addEventListener('submit', async (e) =\u003e {\n        e.preventDefault();\n        const formData = new FormData(form);\n        const content_md = formData.get('content_md');\n        if (!content_md.trim()) return;\n\n        try {\n            const newComment = await BlogService.addComment(postId, {\n                content_md,\n                parent_comment_id: parentCommentId,\n            });\n            onCommentAdded(newComment, parentCommentId);\n            form.remove(); // Hide form after successful submission\n        } catch (error) {\n            console.error('Failed to add comment:', error);\n            // Optionally show an error message to the user\n        }\n    });\n\n    return form;\n}\n\nexport const CommentItem = (comment, postId, onCommentAdded) =\u003e {\n    const commentEl = document.createElement('div');\n    commentEl.className = 'comment-item py-2';\n    commentEl.dataset.commentId = comment.id;\n\n    const author = comment.username?.String || 'Anonymous';\n    const date = new Date(comment.created_at).toLocaleDateString();\n\n    commentEl.innerHTML = `\n        \u003cdiv class=\"flex items-start space-x-3\"\u003e\n            \u003cdiv class=\"flex-shrink-0\"\u003e\n                \u003cdiv class=\"w-8 h-8 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center font-bold text-sm\"\u003e\n                    ${author.charAt(0).toUpperCase()}\n                \u003c/div\u003e\n            \u003c/div\u003e\n            \u003cdiv class=\"flex-1\"\u003e\n                \u003cdiv class=\"bg-gray-100 dark:bg-gray-800 rounded-lg p-3\"\u003e\n                    \u003cp class=\"font-semibold text-sm\"\u003e${author}\u003c/p\u003e\n                    \u003cdiv class=\"prose prose-sm dark:prose-invert max-w-none\"\u003e${comment.content_html}\u003c/div\u003e\n                \u003c/div\u003e\n                \u003cdiv class=\"flex items-center space-x-4 text-xs text-gray-500 dark:text-gray-400 mt-1\"\u003e\n                    \u003cspan\u003e${date}\u003c/span\u003e\n                    \u003cbutton class=\"like-comment-btn font-semibold hover:underline\" data-content-type=\"comment\" data-content-id=\"${comment.id}\"\u003eLike\u003c/button\u003e\n                    ${isLoggedIn() ? `\u003cbutton class=\"reply-btn font-semibold hover:underline\"\u003eReply\u003c/button\u003e` : ''}\n                \u003c/div\u003e\n                \u003cdiv class=\"reply-form-container mt-2\"\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    `;\n\n    const repliesContainer = document.createElement('div');\n    repliesContainer.className = 'replies-container ml-6 pl-4 border-l-2 border-gray-200 dark:border-gray-700';\n    if (comment.replies \u0026\u0026 comment.replies.length \u003e 0) {\n        comment.replies.forEach(reply =\u003e {\n            repliesContainer.appendChild(CommentItem(reply, postId, onCommentAdded));\n        });\n    }\n    commentEl.appendChild(repliesContainer);\n\n    const replyBtn = commentEl.querySelector('.reply-btn');\n    if (replyBtn) {\n        replyBtn.addEventListener('click', () =\u003e {\n            const replyFormContainer = commentEl.querySelector('.reply-form-container');\n            if (replyFormContainer.innerHTML === '') {\n                const form = createCommentForm(postId, comment.id, onCommentAdded);\n                replyFormContainer.appendChild(form);\n            } else {\n                replyFormContainer.innerHTML = '';\n            }\n        });\n    }\n\n    return commentEl;\n};\n",
  "client/js/components/Navbar.js": "import { getTheme, toggleTheme } from '../state/themeState.js';\nimport { isLoggedIn, logout, subscribe, getUser } from '../state/authState.js'; // Added getUser\nimport { navigate } from '../router.js';\n\nexport const Navbar = () =\u003e {\n    const nav = document.createElement('nav');\n    // Kept original className for sticky behavior\n    nav.className = 'bg-white dark:bg-gray-800 shadow p-4 flex justify-between items-center sticky top-0 z-10';\n\n    const render = () =\u003e {\n        const currentTheme = getTheme();\n        const loggedIn = isLoggedIn();\n        const user = getUser(); // Added from attempted\n\n        let authLinks = `\n            \u003ca href=\"/login\" data-link class=\"text-gray-600 dark:text-gray-300 hover:text-blue-500\"\u003eLogin\u003c/a\u003e\n            \u003ca href=\"/register\" data-link class=\"text-gray-600 dark:text-gray-300 hover:text-blue-500\"\u003eRegister\u003c/a\u003e\n        `;\n\n        if (loggedIn \u0026\u0026 user) {\n            authLinks = `\n                \u003ca href=\"/profile/${user.username}\" data-link class=\"text-gray-600 dark:text-gray-300 hover:text-blue-500\"\u003eProfile\u003c/a\u003e\n                \u003cbutton id=\"logout-btn\" class=\"text-gray-600 dark:text-gray-300 hover:text-blue-500\"\u003eLogout\u003c/button\u003e\n            `;\n        }\n\n        nav.innerHTML = `\n            \u003ca href=\"/\" data-link class=\"text-xl font-bold text-gray-800 dark:text-white\"\u003eJob Tracker\u003c/a\u003e\n            \u003cdiv class=\"flex items-center space-x-4\"\u003e\n                \u003ca href=\"/dashboard\" data-link class=\"text-gray-600 dark:text-gray-300 hover:text-blue-500\"\u003eDashboard\u003c/a\u003e\n                \u003ca href=\"/applications\" data-link class=\"text-gray-600 dark:text-gray-300 hover:text-blue-500\"\u003eApplications\u003c/a\u003e\n                \u003ca href=\"/blog\" data-link class=\"text-gray-600 dark:text-gray-300 hover:text-blue-500\"\u003eBlog\u003c/a\u003e\n                ${authLinks}\n                \u003cbutton id=\"theme-switcher\" class=\"p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500\"\u003e\n                    \u003cspan class=\"theme-icon\"\u003e${currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô'}\u003c/span\u003e\n                \u003c/button\u003e\n            \u003c/div\u003e\n        `;\n\n        nav.querySelector('#theme-switcher').addEventListener('click', () =\u003e {\n            const newTheme = toggleTheme();\n            nav.querySelector('.theme-icon').textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';\n        });\n\n        if (loggedIn) {\n            // Used optional chaining for logout-btn as it might not exist if not logged in\n            nav.querySelector('#logout-btn')?.addEventListener('click', () =\u003e {\n                logout();\n                navigate('/login');\n            });\n        }\n    };\n\n    subscribe(render); // Re-render when auth state changes\n    render(); // Initial render\n\n    return nav;\n};\n",
  "client/js/main.js": "import { initializeRouter, handleRoute } from './router.js';\nimport { initializeTheme } from './state/themeState.js';\nimport { Navbar } from './components/Navbar.js';\n\nconst appContainer = document.getElementById('app');\n\nfunction renderLayout() {\n    appContainer.innerHTML = ''; // Clear previous content\n    const navbar = Navbar();\n    const mainContent = document.createElement('main');\n    mainContent.id = 'main-content';\n    mainContent.className = 'flex-grow container mx-auto p-4';\n\n    appContainer.appendChild(navbar);\n    appContainer.appendChild(mainContent);\n    return mainContent;\n}\n\ndocument.addEventListener('DOMContentLoaded', () =\u003e {\n    initializeTheme();\n    const mainContentContainer = renderLayout();\n    initializeRouter(mainContentContainer);\n    handleRoute();\n});",
  "client/js/router.js": "import { HomeView } from './views/HomeView.js';\nimport { DashboardView } from './views/DashboardView.js';\nimport { LoginView } from './views/auth/LoginView.js';\nimport { RegisterView } from './views/auth/RegisterView.js';\nimport { ApplicationListView } from './views/applications/ApplicationListView.js';\nimport { ApplicationDetailView } from './views/applications/ApplicationDetailView.js';\nimport { ApplicationFormView } from './views/applications/ApplicationFormView.js';\nimport { BlogListView } from './views/blog/BlogListView.js';\nimport { BlogPostDetailView } from './views/blog/BlogPostDetailView.js';\nimport { BlogPostEditorView } from './views/blog/BlogPostEditorView.js';\nimport { ProfileView } from './views/profile/ProfileView.js'; // Added from attempted\n\nlet mainContentContainer;\n\nconst routes = [\n    { path: '/', view: HomeView },\n    { path: '/dashboard', view: DashboardView },\n    { path: '/login', view: LoginView },\n    { path: '/register', view: RegisterView },\n    { path: '/applications', view: ApplicationListView },\n    { path: '/applications/new', view: ApplicationFormView },\n    { path: '/applications/:id', view: ApplicationDetailView },\n    { path: '/applications/:id/edit', view: ApplicationFormView },\n    { path: \"/blog\", view: BlogListView },\n    { path: \"/blog/new\", view: BlogPostEditorView },\n    { path: \"/blog/:username/:slug\", view: BlogPostDetailView },\n    { path: '/profile/:username', view: ProfileView }, // Added from attempted\n];\n\nconst pathToRegex = path =\u003e new RegExp(\"^\" + path.replace(/\\//g, \"\\\\/\").replace(/:\\w+/g, \"(.+)\") + \"$\"); // Adopted attempted's regex\n\nconst getParams = match =\u003e {\n    const values = match.result.slice(1);\n    const keys = Array.from(match.route.path.matchAll(/:(\\w+)/g)).map(result =\u003e result[1]);\n    return Object.fromEntries(keys.map((key, i) =\u003e [key, values[i]]));\n};\n\nexport const navigate = (path) =\u003e {\n    history.pushState(null, null, path);\n    handleRoute();\n};\n\nexport const handleRoute = async () =\u003e {\n    const potentialMatches = routes.map(route =\u003e {\n        return {\n            route: route,\n            result: location.pathname.match(pathToRegex(route.path))\n        };\n    });\n\n    let match = potentialMatches.find(potentialMatch =\u003e potentialMatch.result !== null);\n\n    if (!match) {\n        match = {\n            route: { path: '/404', view: { render: (container) =\u003e container.innerHTML = '\u003ch1\u003e404 Not Found\u003c/h1\u003e' } },\n            result: [location.pathname]\n        };\n    }\n\n    const params = getParams(match);\n    await match.route.view.render(mainContentContainer, params);\n};\n\nexport const initializeRouter = (container) =\u003e {\n    mainContentContainer = container;\n    window.addEventListener('popstate', handleRoute);\n    document.body.addEventListener('click', e =\u003e {\n        if (e.target.matches('[data-link]')) {\n            e.preventDefault();\n            navigate(e.target.href);\n        } else if (e.target.closest(\"[data-link]\")) { // Kept original's robust click handler\n            e.preventDefault();\n            navigate(e.target.closest(\"[data-link]\").href);\n        }\n    });\n    handleRoute();\n};\n",
  "client/js/services/applicationService.js": "import { getToken, getUser } from '../state/authState.js';\n\nconst API_BASE_URL = '/api';\n\nasync function handleResponse(response) {\n    if (response.status === 204) {\n        return null;\n    }\n    const data = await response.json();\n    if (!response.ok) {\n        throw new Error(data.message || `HTTP error! status: ${response.status}`);\n    }\n    return data;\n}\n\nasync function authorizedFetch(url, options = {}) {\n    const token = getToken();\n    const headers = {\n        'Content-Type': 'application/json',\n        ...options.headers,\n    };\n    if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n    }\n    const response = await fetch(url, { ...options, headers });\n    return handleResponse(response);\n}\n\nexport const ApplicationService = {\n    getApplications: async (params = {}) =\u003e {\n        const query = new URLSearchParams(params).toString();\n        const url = `${API_BASE_URL}/applications?${query}`;\n        return authorizedFetch(url);\n    },\n\n    getApplication: async (id) =\u003e {\n        return authorizedFetch(`${API_BASE_URL}/applications/${id}`);\n    },\n\n    createApplication: async (appData) =\u003e {\n        return authorizedFetch(`${API_BASE_URL}/applications`, {\n            method: 'POST',\n            body: JSON.stringify(appData),\n        });\n    },\n\n    updateApplication: async (id, appData) =\u003e {\n        return authorizedFetch(`${API_BASE_URL}/applications/${id}`, {\n            method: 'PUT',\n            body: JSON.stringify(appData),\n        });\n    },\n\n    deleteApplication: async (id) =\u003e {\n        return authorizedFetch(`${API_BASE_URL}/applications/${id}`, {\n            method: 'DELETE',\n        });\n    },\n};\n",
  "client/js/services/authService.js": "import { handleResponse } from './utils.js'; // Changed to import handleResponse\n\nconst API_BASE_URL = '/api';\n\nexport const AuthService = {\n    login: async (email, password) =\u003e {\n        const response = await fetch(`${API_BASE_URL}/auth/login`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ email, password })\n        });\n        return handleResponse(response);\n    },\n\n    register: async (username, email, password) =\u003e {\n        const response = await fetch(`${API_BASE_URL}/auth/register`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ username, email, password })\n        });\n        return handleResponse(response);\n    },\n};\n",
  "client/js/services/blogService.js": "import { getToken } from '../state/authState.js';\n\nconst API_BASE_URL = '/api';\n\nasync function handleResponse(response) {\n    if (response.status === 204) {\n        return null;\n    }\n    const data = await response.json();\n    if (!response.ok) {\n        throw new Error(data.message || 'An error occurred');\n    }\n    return data;\n}\n\nasync function authorizedFetch(url, options = {}) {\n    const token = getToken();\n    const headers = {\n        'Content-Type': 'application/json',\n        ...options.headers,\n    };\n    if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n    }\n\n    const response = await fetch(url, { ...options, headers });\n    return handleResponse(response);\n}\n\nexport const BlogService = {\n    getPublicPosts: async (params = {}) =\u003e {\n        const query = new URLSearchParams(params).toString();\n        const response = await fetch(`${API_BASE_URL}/blog/posts?${query}`);\n        return handleResponse(response);\n    },\n\n    getPublicPost: async (username, slug) =\u003e {\n        const response = await fetch(`${API_BASE_URL}/blog/posts/${username}/${slug}`);\n        return handleResponse(response);\n    },\n\n    createPost: async (postData) =\u003e {\n        return authorizedFetch(`${API_BASE_URL}/blog/posts`, {\n            method: 'POST',\n            body: JSON.stringify(postData),\n        });\n    },\n\n    getComments: async (postId) =\u003e {\n        const response = await fetch(`${API_BASE_URL}/blog/posts/${postId}/comments`);\n        return handleResponse(response);\n    },\n\n    addComment: async (postId, commentData) =\u003e {\n        return authorizedFetch(`${API_BASE_URL}/blog/posts/${postId}/comments`, {\n            method: 'POST',\n            body: JSON.stringify(commentData),\n        });\n    },\n\n    toggleLike: async (likeData) =\u003e {\n        return authorizedFetch(`${API_BASE_URL}/blog/like`, {\n            method: 'POST',\n            body: JSON.stringify(likeData),\n        });\n    },\n};\n",
  "client/js/services/userService.js": "import { authorizedFetch, handleResponse } from './utils.js';\n\nconst API_BASE_URL = '/api/users';\n\nexport const UserService = {\n    getProfile: async (username) =\u003e {\n        // Use authorizedFetch to send token if available, but it's not strictly required by the backend\n        const response = await authorizedFetch(`${API_BASE_URL}/${username}/profile`);\n        return handleResponse(response);\n    },\n\n    follow: async (username) =\u003e {\n        const response = await authorizedFetch(`${API_BASE_URL}/${username}/follow`, {\n            method: 'POST',\n        });\n        return handleResponse(response);\n    },\n\n    unfollow: async (username) =\u003e {\n        const response = await authorizedFetch(`${API_BASE_URL}/${username}/follow`, {\n            method: 'DELETE',\n        });\n        return handleResponse(response);\n    },\n};\n",
  "client/js/state/authState.js": "let token = localStorage.getItem('jwt_token');\nlet user = JSON.parse(localStorage.getItem('current_user')); // Updated to store user object\n\nconst subscribers = new Set();\n\nfunction notify() { // Changed to function declaration\n    subscribers.forEach(callback =\u003e callback());\n}\n\nexport function setToken(newToken, newUser) { // Updated signature to include newUser\n    token = newToken;\n    user = newUser;\n    if (token \u0026\u0026 user) {\n        localStorage.setItem('jwt_token', token);\n        localStorage.setItem('current_user', JSON.stringify(user)); // Store user object\n    } else {\n        localStorage.removeItem('jwt_token');\n        localStorage.removeItem('current_user'); // Remove user object\n    }\n    notify();\n}\n\nexport function getToken() { // Changed to function declaration\n    return token;\n}\n\nexport function getUser() { // Added from attempted\n    return user;\n}\n\nexport function isLoggedIn() { // Changed to function declaration\n    return !!token;\n}\n\nexport function logout() { // Changed to function declaration\n    setToken(null, null); // Updated to clear user object\n}\n\nexport function subscribe(callback) { // Changed to function declaration\n    subscribers.add(callback);\n    // Return an unsubscribe function\n    return () =\u003e subscribers.delete(callback);\n}\n",
  "client/js/state/themeState.js": "let currentTheme = localStorage.getItem('theme') || 'light';\n\nconst applyTheme = (theme) =\u003e {\n    if (theme === 'dark') {\n        document.documentElement.classList.add('dark');\n    } else {\n        document.documentElement.classList.remove('dark');\n    }\n};\n\nexport const getTheme = () =\u003e currentTheme;\n\nexport const toggleTheme = () =\u003e {\n    currentTheme = currentTheme === 'light' ? 'dark' : 'light';\n    localStorage.setItem('theme', currentTheme);\n    applyTheme(currentTheme);\n    return currentTheme;\n};\n\nexport const initializeTheme = () =\u003e {\n    applyTheme(currentTheme);\n};\n",
  "client/js/utils/markdownParser.js": "export const parseMarkdown = (markdownText) =\u003e {\n    if (window.marked) {\n        // In a real app, you'd configure marked with sanitization options\n        return window.marked.parse(markdownText, { gfm: true, breaks: true });\n    }\n    console.error(\"Marked.js library not loaded.\");\n    return markdownText; // Fallback\n};\n",
  "client/js/views/DashboardView.js": "export const DashboardView = {\n    render: (container) =\u003e {\n        container.innerHTML = `\n            \u003cdiv\u003e\n                \u003ch1 class=\"text-3xl font-bold mb-6\"\u003eDashboard\u003c/h1\u003e\n                \u003cdiv class=\"p-6 bg-white dark:bg-gray-800 rounded-lg shadow\"\u003e\n                    \u003cp\u003eAnalytics and charts will be displayed here.\u003c/p\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n        `;\n    }\n};\n```",
  "client/js/views/HomeView.js": "export const HomeView = {\n    render: (container) =\u003e {\n        container.innerHTML = `\n            \u003cdiv class=\"text-center py-16\"\u003e\n                \u003ch1 class=\"text-4xl font-bold mb-4\"\u003eWelcome to Job App Tracker\u003c/h1\u003e\n                \u003cp class=\"text-lg text-gray-600 dark:text-gray-400\"\u003eYour personal dashboard for managing job applications.\u003c/p\u003e\n            \u003c/div\u003e\n        `;\n    }\n};\n",
  "client/js/views/applications/ApplicationDetailView.js": "import { ApplicationService } from '../../services/applicationService.js';\nimport { navigate } from '../../router.js';\n\nexport const ApplicationDetailView = {\n    render: async (container, params) =\u003e {\n        container.innerHTML = `\u003cp\u003eLoading application details...\u003c/p\u003e`;\n\n        try {\n            const app = await ApplicationService.getApplication(params.id);\n            if (!app) {\n                container.innerHTML = `\u003cp\u003eApplication not found.\u003c/p\u003e`;\n                return;\n            }\n\n            const date = new Date(app.DateApplied).toLocaleDateString();\n\n            container.innerHTML = `\n                \u003cdiv class=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow\"\u003e\n                    \u003cdiv class=\"flex justify-between items-start mb-4\"\u003e\n                        \u003cdiv\u003e\n                            \u003ch1 class=\"text-3xl font-bold\"\u003e${app.RoleID}\u003c/h1\u003e\n                            \u003cp class=\"text-xl text-gray-600 dark:text-gray-400\"\u003e${app.CompanyID}\u003c/p\u003e\n                        \u003c/div\u003e\n                        \u003ca href=\"/applications/${app.ID}/edit\" data-link class=\"bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded\"\u003eEdit\u003c/a\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\"space-y-2\"\u003e\n                        \u003cp\u003e\u003cstrong\u003eStatus:\u003c/strong\u003e ${app.Status}\u003c/p\u003e\n                        \u003cp\u003e\u003cstrong\u003eDate Applied:\u003c/strong\u003e ${date}\u003c/p\u003e\n                    \u003c/div\u003e\n                    \u003chr class=\"my-6 border-gray-200 dark:border-gray-700\"\u003e\n                    \u003ch2 class=\"text-2xl font-bold mb-4\"\u003eNotes\u003c/h2\u003e\n                    \u003cdiv id=\"notes-list\"\u003e\n                        \u003c!-- Notes will be rendered here --\u003e\n                        \u003cp class=\"text-gray-500\"\u003eNotes functionality coming soon.\u003c/p\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n            `;\n        } catch (error) {\n            console.error('Failed to load application details:', error);\n            container.innerHTML = `\u003cp\u003eError loading application. You may not have permission to view this.\u003c/p\u003e`;\n        }\n    }\n};\n",
  "client/js/views/applications/ApplicationFormView.js": "import { ApplicationService } from '../../services/applicationService.js';\nimport { navigate } from '../../router.js';\n\nexport const ApplicationFormView = {\n    render: async (container, params) =\u003e {\n        const isEditing = !!params.id;\n        let app = { CompanyName: '', RoleTitle: '', Status: 'Applied', DateApplied: new Date().toISOString().split('T')[0] };\n\n        if (isEditing) {\n            try {\n                const existingApp = await ApplicationService.getApplication(params.id);\n                // TODO: The service returns IDs, not names. This is a placeholder.\n                // For a real implementation, the API should return joined data or we need separate lookups.\n                app.CompanyName = `CompanyID ${existingApp.CompanyID}`;\n                app.RoleTitle = `RoleID ${existingApp.RoleID}`;\n                app.Status = existingApp.Status;\n                app.DateApplied = new Date(existingApp.DateApplied).toISOString().split('T')[0];\n            } catch (error) {\n                container.innerHTML = `\u003cp\u003eCould not load application to edit.\u003c/p\u003e`;\n                return;\n            }\n        }\n\n        container.innerHTML = `\n            \u003ch1 class=\"text-3xl font-bold mb-6\"\u003e${isEditing ? 'Edit' : 'Add New'} Application\u003c/h1\u003e\n            \u003cform id=\"app-form\" class=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow space-y-4\"\u003e\n                \u003cdiv id=\"form-error\" class=\"hidden text-red-500 bg-red-100 dark:bg-red-900 p-3 rounded\"\u003e\u003c/div\u003e\n                \u003cdiv\u003e\n                    \u003clabel for=\"companyName\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003eCompany Name\u003c/label\u003e\n                    \u003cinput type=\"text\" id=\"companyName\" name=\"companyName\" required class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600\" value=\"${app.CompanyName}\"\u003e\n                \u003c/div\u003e\n                \u003cdiv\u003e\n                    \u003clabel for=\"roleTitle\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003eRole Title\u003c/label\u003e\n                    \u003cinput type=\"text\" id=\"roleTitle\" name=\"roleTitle\" required class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600\" value=\"${app.RoleTitle}\"\u003e\n                \u003c/div\u003e\n                \u003cdiv\u003e\n                    \u003clabel for=\"status\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003eStatus\u003c/label\u003e\n                    \u003cinput type=\"text\" id=\"status\" name=\"status\" required class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600\" value=\"${app.Status}\"\u003e\n                \u003c/div\u003e\n                \u003cdiv\u003e\n                    \u003clabel for=\"dateApplied\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003eDate Applied\u003c/label\u003e\n                    \u003cinput type=\"date\" id=\"dateApplied\" name=\"dateApplied\" required class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600\" value=\"${app.DateApplied}\"\u003e\n                \u003c/div\u003e\n                \u003cdiv class=\"flex justify-end\"\u003e\n                    \u003cbutton type=\"submit\" class=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\"\u003e\n                        ${isEditing ? 'Save Changes' : 'Create Application'}\n                    \u003c/button\u003e\n                \u003c/div\u003e\n            \u003c/form\u003e\n        `;\n\n        const form = container.querySelector('#app-form');\n        form.addEventListener('submit', async (e) =\u003e {\n            e.preventDefault();\n            const formData = new FormData(form);\n            const data = Object.fromEntries(formData.entries());\n            const errorDiv = container.querySelector('#form-error');\n            errorDiv.classList.add('hidden');\n\n            try {\n                if (isEditing) {\n                    await ApplicationService.updateApplication(params.id, data);\n                    navigate(`/applications/${params.id}`);\n                } else {\n                    const newApp = await ApplicationService.createApplication(data);\n                    navigate(`/applications/${newApp.ID}`);\n                }\n            } catch (error) {\n                errorDiv.textContent = error.message;\n                errorDiv.classList.remove('hidden');\n            }\n        });\n    }\n};\n```",
  "client/js/views/applications/ApplicationListView.js": "import { ApplicationService } from '../../services/applicationService.js';\nimport { ApplicationCard } from '../../components/ApplicationCard.js';\nimport { navigate } from '../../router.js';\n\nexport const ApplicationListView = {\n    render: async (container) =\u003e {\n        let state = {\n            page: 1,\n            limit: 10,\n            search: '',\n            status: '',\n            sortBy: 'date_applied',\n            sortOrder: 'desc',\n        };\n\n        const updateView = async () =\u003e {\n            container.innerHTML = `\n                \u003cdiv class=\"flex justify-between items-center mb-4\"\u003e\n                    \u003ch1 class=\"text-2xl font-bold\"\u003eMy Job Applications\u003c/h1\u003e\n                    \u003ca href=\"/applications/new\" data-link class=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\"\u003eAdd New Application\u003c/a\u003e\n                \u003c/div\u003e\n\n                \u003c!-- Filters and Search --\u003e\n                \u003cdiv class=\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4 flex flex-wrap gap-4 items-center\"\u003e\n                    \u003cdiv class=\"flex-grow\"\u003e\n                        \u003clabel for=\"search\" class=\"sr-only\"\u003eSearch\u003c/label\u003e\n                        \u003cinput type=\"text\" id=\"search\" placeholder=\"Search by company or role...\" value=\"${state.search}\" class=\"w-full p-2 border rounded bg-gray-50 dark:bg-gray-700 dark:border-gray-600\"\u003e\n                    \u003c/div\u003e\n                    \u003cdiv\u003e\n                        \u003clabel for=\"status-filter\" class=\"sr-only\"\u003eStatus\u003c/label\u003e\n                        \u003cselect id=\"status-filter\" class=\"p-2 border rounded bg-gray-50 dark:bg-gray-700 dark:border-gray-600\"\u003e\n                            \u003coption value=\"\"\u003eAll Statuses\u003c/option\u003e\n                            \u003coption value=\"Applied\" ${state.status === 'Applied' ? 'selected' : ''}\u003eApplied\u003c/option\u003e\n                            \u003coption value=\"Interviewing\" ${state.status === 'Interviewing' ? 'selected' : ''}\u003eInterviewing\u003c/option\u003e\n                            \u003coption value=\"Offer\" ${state.status === 'Offer' ? 'selected' : ''}\u003eOffer\u003c/option\u003e\n                            \u003coption value=\"Rejected\" ${state.status === 'Rejected' ? 'selected' : ''}\u003eRejected\u003c/option\u003e\n                        \u003c/select\u003e\n                    \u003c/div\u003e\n                     \u003cdiv\u003e\n                        \u003clabel for=\"sort-by\" class=\"sr-only\"\u003eSort By\u003c/label\u003e\n                        \u003cselect id=\"sort-by\" class=\"p-2 border rounded bg-gray-50 dark:bg-gray-700 dark:border-gray-600\"\u003e\n                            \u003coption value=\"date_applied\" ${state.sortBy === 'date_applied' ? 'selected' : ''}\u003eDate Applied\u003c/option\u003e\n                            \u003coption value=\"company\" ${state.sortBy === 'company' ? 'selected' : ''}\u003eCompany\u003c/option\u003e\n                            \u003coption value=\"role\" ${state.sortBy === 'role' ? 'selected' : ''}\u003eRole\u003c/option\u003e\n                            \u003coption value=\"status\" ${state.sortBy === 'status' ? 'selected' : ''}\u003eStatus\u003c/option\u003e\n                        \u003c/select\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n\n                \u003cdiv id=\"application-list-container\" class=\"space-y-4\"\u003e\n                    \u003cp\u003eLoading applications...\u003c/p\u003e\n                \u003c/div\u003e\n                \u003cdiv id=\"pagination-container\" class=\"mt-6 flex justify-between items-center\"\u003e\u003c/div\u003e\n            `;\n\n            const listContainer = container.querySelector('#application-list-container');\n            const paginationContainer = container.querySelector('#pagination-container');\n\n            try {\n                const data = await ApplicationService.getApplications(state);\n                const { applications, pagination } = data;\n\n                if (applications \u0026\u0026 applications.length \u003e 0) {\n                    listContainer.innerHTML = '';\n                    applications.forEach(app =\u003e {\n                        listContainer.appendChild(ApplicationCard(app));\n                    });\n                } else {\n                    listContainer.innerHTML = '\u003cp\u003eNo applications found. Add one to get started!\u003c/p\u003e';\n                }\n\n                // Render pagination\n                paginationContainer.innerHTML = `\n                    \u003cdiv\u003e\n                        \u003cspan class=\"text-sm text-gray-700 dark:text-gray-400\"\u003e\n                            Showing page ${pagination.currentPage} of ${pagination.totalPages} (${pagination.totalItems} total)\n                        \u003c/span\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\"inline-flex mt-2 xs:mt-0\"\u003e\n                        \u003cbutton id=\"prev-page\" class=\"px-4 py-2 text-sm font-medium text-white bg-gray-800 rounded-l hover:bg-gray-900 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white disabled:opacity-50 disabled:cursor-not-allowed\" ${pagination.currentPage \u003c= 1 ? 'disabled' : ''}\u003e\n                            Prev\n                        \u003c/button\u003e\n                        \u003cbutton id=\"next-page\" class=\"px-4 py-2 text-sm font-medium text-white bg-gray-800 border-0 border-l border-gray-700 rounded-r hover:bg-gray-900 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white disabled:opacity-50 disabled:cursor-not-allowed\" ${pagination.currentPage \u003e= pagination.totalPages ? 'disabled' : ''}\u003e\n                            Next\n                        \u003c/button\u003e\n                    \u003c/div\u003e\n                `;\n\n                container.querySelector('#prev-page')?.addEventListener('click', () =\u003e {\n                    if (state.page \u003e 1) {\n                        state.page--;\n                        updateView();\n                    }\n                });\n                container.querySelector('#next-page')?.addEventListener('click', () =\u003e {\n                    if (state.page \u003c pagination.totalPages) {\n                        state.page++;\n                        updateView();\n                    }\n                });\n\n            } catch (error) {\n                listContainer.innerHTML = `\u003cp class=\"text-red-500\"\u003eError loading applications: ${error.message}\u003c/p\u003e`;\n                paginationContainer.innerHTML = '';\n            }\n\n            // Add event listeners after rendering controls\n            container.querySelector('#search').addEventListener('change', (e) =\u003e {\n                state.search = e.target.value;\n                state.page = 1; // Reset to first page on new search\n                updateView();\n            });\n            container.querySelector('#status-filter').addEventListener('change', (e) =\u003e {\n                state.status = e.target.value;\n                state.page = 1;\n                updateView();\n            });\n            container.querySelector('#sort-by').addEventListener('change', (e) =\u003e {\n                state.sortBy = e.target.value;\n                state.page = 1;\n                updateView();\n            });\n        };\n\n        await updateView();\n    }\n};\n",
  "client/js/views/auth/LoginView.js": "import { AuthService } from '../../services/authService.js';\nimport { setToken } from '../../state/authState.js';\nimport { navigate } from '../../router.js';\n\nexport const LoginView = {\n    render: (container) =\u003e {\n        container.innerHTML = `\n            \u003cdiv class=\"max-w-md mx-auto mt-10 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md\"\u003e\n                \u003ch2 class=\"text-2xl font-bold mb-6 text-center\"\u003eLogin\u003c/h2\u003e\n                \u003cform id=\"login-form\"\u003e\n                    \u003cdiv class=\"mb-4\"\u003e\n                        \u003clabel for=\"email\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003eEmail\u003c/label\u003e\n                        \u003cinput type=\"email\" id=\"email\" name=\"email\" required class=\"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\"mb-6\"\u003e\n                        \u003clabel for=\"password\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003ePassword\u003c/label\u003e\n                        \u003cinput type=\"password\" id=\"password\" name=\"password\" required class=\"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\u003e\n                    \u003c/div\u003e\n                    \u003cbutton type=\"submit\" class=\"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\u003eLogin\u003c/button\u003e\n                    \u003cp id=\"error-message\" class=\"text-red-500 text-sm mt-4 text-center\"\u003e\u003c/p\u003e\n                \u003c/form\u003e\n                \u003cp class=\"mt-4 text-center text-sm\"\u003e\n                    Don't have an account? \u003ca href=\"/register\" data-link class=\"text-blue-500 hover:underline\"\u003eRegister here\u003c/a\u003e.\n                \u003c/p\u003e\n            \u003c/div\u003e\n        `;\n\n        const form = container.querySelector('#login-form');\n        const errorMessage = container.querySelector('#error-message');\n\n        form.addEventListener('submit', async (e) =\u003e {\n            e.preventDefault();\n            errorMessage.textContent = ''; // Simpler error clearing\n            const email = form.email.value;\n            const password = form.password.value;\n\n            try {\n                const data = await AuthService.login(email, password);\n                setToken(data.token, data.user); // Updated to pass user object\n                navigate('/dashboard');\n            } catch (error) {\n                errorMessage.textContent = error.message || 'Login failed. Please try again.'; // Improved error message\n            }\n        });\n    }\n};",
  "client/js/views/auth/RegisterView.js": "import { AuthService } from '../../services/authService.js';\nimport { navigate } from '../../router.js';\n\nexport const RegisterView = {\n    render: (container) =\u003e {\n        container.innerHTML = `\n            \u003cdiv class=\"max-w-md mx-auto mt-10 p-8 border rounded-lg shadow-lg bg-white dark:bg-gray-800\"\u003e\n                \u003ch2 class=\"text-2xl font-bold mb-6 text-center\"\u003eRegister\u003c/h2\u003e\n                \u003cform id=\"register-form\"\u003e\n                    \u003cdiv id=\"error-message\" class=\"hidden text-red-500 mb-4 p-2 bg-red-100 dark:bg-red-900 rounded\"\u003e\u003c/div\u003e\n                    \u003cdiv class=\"mb-4\"\u003e\n                        \u003clabel for=\"username\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003eUsername\u003c/label\u003e\n                        \u003cinput type=\"text\" id=\"username\" name=\"username\" required class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600\"\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\"mb-4\"\u003e\n                        \u003clabel for=\"email\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003eEmail\u003c/label\u003e\n                        \u003cinput type=\"email\" id=\"email\" name=\"email\" required class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600\"\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\"mb-6\"\u003e\n                        \u003clabel for=\"password\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003ePassword\u003c/label\u003e\n                        \u003cinput type=\"password\" id=\"password\" name=\"password\" required class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600\"\u003e\n                    \u003c/div\u003e\n                    \u003cbutton type=\"submit\" class=\"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\u003e\n                        Register\n                    \u003c/button\u003e\n                \u003c/form\u003e\n                 \u003cp class=\"mt-4 text-center text-sm\"\u003e\n                    Already have an account? \u003ca href=\"/login\" data-link class=\"text-blue-500 hover:underline\"\u003eLogin here\u003c/a\u003e.\n                \u003c/p\u003e\n            \u003c/div\u003e\n        `;\n\n        const form = container.querySelector('#register-form');\n        const errorMessage = container.querySelector('#error-message');\n        form.addEventListener('submit', async (e) =\u003e {\n            e.preventDefault();\n            errorMessage.classList.add('hidden');\n            const username = form.username.value;\n            const email = form.email.value;\n            const password = form.password.value;\n\n            try {\n                await AuthService.register(username, email, password);\n                navigate('/login'); // Redirect to login after successful registration\n            } catch (error) {\n                errorMessage.textContent = error.message;\n                errorMessage.classList.remove('hidden');\n            }\n        });\n    }\n};\n",
  "client/js/views/blog/BlogListView.js": "import { BlogService } from '../../services/blogService.js';\nimport { BlogPostCard } from '../../components/BlogPostCard.js';\nimport { isLoggedIn } from '../../state/authState.js';\n\nexport const BlogListView = {\n    render: async (container) =\u003e {\n        let state = {\n            page: 1,\n            limit: 10,\n            search: '',\n        };\n\n        const updateView = async () =\u003e {\n            const loggedIn = isLoggedIn();\n            container.innerHTML = `\n                \u003cdiv class=\"flex justify-between items-center mb-4\"\u003e\n                    \u003ch1 class=\"text-2xl font-bold\"\u003ePublic Blog Posts\u003c/h1\u003e\n                    ${loggedIn ? '\u003ca href=\"/blog/new\" data-link class=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\"\u003eCreate New Post\u003c/a\u003e' : ''}\n                \u003c/div\u003e\n\n                \u003c!-- Search --\u003e\n                \u003cdiv class=\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4\"\u003e\n                    \u003cinput type=\"text\" id=\"search\" placeholder=\"Search by title...\" value=\"${state.search}\" class=\"w-full p-2 border rounded bg-gray-50 dark:bg-gray-700 dark:border-gray-600\"\u003e\n                \u003c/div\u003e\n\n                \u003cdiv id=\"blog-list-container\" class=\"space-y-4\"\u003e\n                    \u003cp\u003eLoading posts...\u003c/p\u003e\n                \u003c/div\u003e\n                \u003cdiv id=\"pagination-container\" class=\"mt-6 flex justify-between items-center\"\u003e\u003c/div\u003e\n            `;\n\n            const listContainer = container.querySelector('#blog-list-container');\n            const paginationContainer = container.querySelector('#pagination-container');\n\n            try {\n                const data = await BlogService.getPublicPosts(state);\n                const { posts, pagination } = data;\n\n                if (posts \u0026\u0026 posts.length \u003e 0) {\n                    listContainer.innerHTML = '';\n                    posts.forEach(post =\u003e {\n                        listContainer.appendChild(BlogPostCard(post));\n                    });\n                } else {\n                    listContainer.innerHTML = '\u003cp\u003eNo blog posts found.\u003c/p\u003e';\n                }\n\n                // Render pagination\n                paginationContainer.innerHTML = `\n                    \u003cdiv\u003e\n                        \u003cspan class=\"text-sm text-gray-700 dark:text-gray-400\"\u003e\n                            Showing page ${pagination.currentPage} of ${pagination.totalPages} (${pagination.totalItems} total)\n                        \u003c/span\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\"inline-flex mt-2 xs:mt-0\"\u003e\n                        \u003cbutton id=\"prev-page\" class=\"px-4 py-2 text-sm font-medium text-white bg-gray-800 rounded-l hover:bg-gray-900 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white disabled:opacity-50 disabled:cursor-not-allowed\" ${pagination.currentPage \u003c= 1 ? 'disabled' : ''}\u003e\n                            Prev\n                        \u003c/button\u003e\n                        \u003cbutton id=\"next-page\" class=\"px-4 py-2 text-sm font-medium text-white bg-gray-800 border-0 border-l border-gray-700 rounded-r hover:bg-gray-900 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white disabled:opacity-50 disabled:cursor-not-allowed\" ${pagination.currentPage \u003e= pagination.totalPages ? 'disabled' : ''}\u003e\n                            Next\n                        \u003c/button\u003e\n                    \u003c/div\u003e\n                `;\n\n                container.querySelector('#prev-page')?.addEventListener('click', () =\u003e {\n                    if (state.page \u003e 1) {\n                        state.page--;\n                        updateView();\n                    }\n                });\n                container.querySelector('#next-page')?.addEventListener('click', () =\u003e {\n                    if (state.page \u003c pagination.totalPages) {\n                        state.page++;\n                        updateView();\n                    }\n                });\n\n            } catch (error) {\n                listContainer.innerHTML = `\u003cp class=\"text-red-500\"\u003eError loading posts: ${error.message}\u003c/p\u003e`;\n                paginationContainer.innerHTML = '';\n            }\n\n            container.querySelector('#search').addEventListener('change', (e) =\u003e {\n                state.search = e.target.value;\n                state.page = 1;\n                updateView();\n            });\n        };\n\n        await updateView();\n    }\n};\n",
  "client/js/views/blog/BlogPostDetailView.js": "import { BlogService } from '../../services/blogService.js';\nimport { isLoggedIn } from '../../state/authState.js';\nimport { CommentItem } from '../../components/CommentItem.js';\n\nfunction renderComments(comments, postId, onCommentAdded) {\n    const container = document.createElement('div');\n    comments.forEach(comment =\u003e {\n        container.appendChild(CommentItem(comment, postId, onCommentAdded));\n    });\n    return container;\n}\n\nexport const BlogPostDetailView = {\n    render: async (container, params) =\u003e {\n        container.innerHTML = `\u003cp class=\"text-center\"\u003eLoading post...\u003c/p\u003e`;\n\n        try {\n            const post = await BlogService.getPublicPost(params.username, params.slug);\n            if (!post) {\n                container.innerHTML = `\u003cp class=\"text-center\"\u003ePost not found.\u003c/p\u003e`;\n                return;\n            }\n\n            const postDate = new Date(post.created_at).toLocaleDateString();\n            container.innerHTML = `\n                \u003carticle class=\"max-w-4xl mx-auto p-4\"\u003e\n                    \u003ch1 class=\"text-4xl font-bold mb-2\"\u003e${post.title}\u003c/h1\u003e\n                    \u003cp class=\"text-gray-600 dark:text-gray-400 mb-4\"\u003eBy ${post.username} on ${postDate}\u003c/p\u003e\n                    \u003cdiv class=\"prose dark:prose-invert lg:prose-xl max-w-none mb-8\"\u003e\n                        ${post.content_html}\n                    \u003c/div\u003e\n                    \u003cdiv class=\"flex items-center space-x-4 mb-8\"\u003e\n                        \u003cbutton id=\"like-post-btn\" class=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\" data-content-type=\"post\" data-content-id=\"${post.id}\"\u003e\n                            Like Post\n                        \u003c/button\u003e\n                    \u003c/div\u003e\n                    \u003chr class=\"my-8 border-gray-200 dark:border-gray-700\"\u003e\n                    \u003csection id=\"comments-section\"\u003e\n                        \u003ch2 class=\"text-2xl font-bold mb-4\"\u003eComments\u003c/h2\u003e\n                        \u003cdiv id=\"comments-list\" class=\"space-y-4\"\u003e\u003c/div\u003e\n                        ${isLoggedIn() ? `\n                        \u003cform id=\"new-comment-form\" class=\"mt-6\"\u003e\n                            \u003ch3 class=\"text-lg font-semibold mb-2\"\u003eLeave a Comment\u003c/h3\u003e\n                            \u003ctextarea name=\"content_md\" class=\"w-full p-2 border rounded bg-gray-50 dark:bg-gray-700 dark:border-gray-600\" rows=\"4\" placeholder=\"Write your comment here...\"\u003e\u003c/textarea\u003e\n                            \u003cbutton type=\"submit\" class=\"mt-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\"\u003ePost Comment\u003c/button\u003e\n                        \u003c/form\u003e\n                        ` : '\u003cp class=\"mt-6\"\u003eYou must be \u003ca href=\"/login\" data-link class=\"text-blue-500 hover:underline\"\u003elogged in\u003c/a\u003e to comment.\u003c/p\u003e'}\n                    \u003c/section\u003e\n                \u003c/article\u003e\n            `;\n\n            const commentsList = container.querySelector('#comments-list');\n            const comments = await BlogService.getComments(post.id);\n\n            const onCommentAdded = (newComment, parentId) =\u003e {\n                const newCommentEl = CommentItem(newComment, post.id, onCommentAdded);\n                if (parentId) {\n                    const parentEl = commentsList.querySelector(`.comment-item[data-comment-id=\"${parentId}\"] .replies-container`);\n                    if (parentEl) {\n                        parentEl.appendChild(newCommentEl);\n                    }\n                } else {\n                    commentsList.appendChild(newCommentEl);\n                }\n            };\n\n            commentsList.appendChild(renderComments(comments, post.id, onCommentAdded));\n\n            if (isLoggedIn()) {\n                const newCommentForm = container.querySelector('#new-comment-form');\n                newCommentForm.addEventListener('submit', async (e) =\u003e {\n                    e.preventDefault();\n                    const formData = new FormData(newCommentForm);\n                    const content_md = formData.get('content_md');\n                    if (!content_md.trim()) return;\n\n                    try {\n                        const newComment = await BlogService.addComment(post.id, { content_md, parent_comment_id: null });\n                        onCommentAdded(newComment, null);\n                        newCommentForm.reset();\n                    } catch (error) {\n                        console.error('Failed to add comment:', error);\n                        alert('Could not post comment.');\n                    }\n                });\n            }\n\n            // Like functionality\n            container.addEventListener('click', async (e) =\u003e {\n                if (e.target.matches('.like-comment-btn, #like-post-btn')) {\n                    if (!isLoggedIn()) {\n                        alert('You must be logged in to like content.');\n                        return;\n                    }\n                    const button = e.target;\n                    const contentType = button.dataset.contentType;\n                    const contentId = parseInt(button.dataset.contentId, 10);\n                    try {\n                        const result = await BlogService.toggleLike({ content_type: contentType, content_id: contentId });\n                        button.textContent = result.is_liked ? 'Unlike' : 'Like';\n                        button.classList.toggle('bg-red-500', result.is_liked);\n                        button.classList.toggle('hover:bg-red-600', result.is_liked);\n                        button.classList.toggle('bg-blue-600', !result.is_liked);\n                        button.classList.toggle('hover:bg-blue-700', !result.is_liked);\n                    } catch (error) {\n                        console.error('Failed to toggle like:', error);\n                        alert('An error occurred while liking.');\n                    }\n                }\n            });\n\n        } catch (error) {\n            console.error('Failed to load post:', error);\n            container.innerHTML = `\u003cp class=\"text-center text-red-500\"\u003eError loading post. ${error.message}\u003c/p\u003e`;\n        }\n    }\n};",
  "client/js/views/blog/BlogPostEditorView.js": "import { BlogService } from '../../services/blogService.js';\nimport { navigate } from '../../router.js';\nimport { parseMarkdown } from '../../utils/markdownParser.js';\n\nlet autosaveTimeout;\n\nexport const BlogPostEditorView = {\n    render: async (container, params) =\u003e {\n        container.innerHTML = `\n            \u003cdiv class=\"container mx-auto px-4 py-8\"\u003e\n                \u003ch1 class=\"text-3xl font-bold mb-6\"\u003eCreate New Post\u003c/h1\u003e\n                \u003cform id=\"blog-editor-form\" class=\"space-y-6\"\u003e\n                    \u003cdiv\u003e\n                        \u003clabel for=\"post-title\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003eTitle\u003c/label\u003e\n                        \u003cinput type=\"text\" id=\"post-title\" name=\"title\" required class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600\"\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\"grid grid-cols-1 md:grid-cols-2 gap-4 h-[60vh]\"\u003e\n                        \u003cdiv\u003e\n                            \u003clabel for=\"post-content-md\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003eContent (Markdown)\u003c/label\u003e\n                            \u003ctextarea id=\"post-content-md\" name=\"contentMd\" required class=\"mt-1 block w-full h-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 font-mono p-2\"\u003e\u003c/textarea\u003e\n                        \u003c/div\u003e\n                        \u003cdiv\u003e\n                            \u003clabel class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\"\u003ePreview\u003c/label\u003e\n                            \u003cdiv id=\"post-preview\" class=\"mt-1 p-3 w-full h-full rounded-md border border-gray-300 bg-gray-50 dark:bg-gray-800 dark:border-gray-600 prose dark:prose-invert max-w-none overflow-y-auto\"\u003e\u003c/div\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\"flex items-center justify-between\"\u003e\n                        \u003cdiv class=\"flex items-center\"\u003e\n                            \u003cinput id=\"is-public\" name=\"isPublic\" type=\"checkbox\" class=\"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500\"\u003e\n                            \u003clabel for=\"is-public\" class=\"ml-2 block text-sm text-gray-900 dark:text-gray-200\"\u003ePublish Publicly\u003c/label\u003e\n                        \u003c/div\u003e\n                        \u003cdiv\u003e\n                            \u003cbutton type=\"button\" id=\"save-draft-btn\" class=\"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded mr-2\"\u003eSave Draft\u003c/button\u003e\n                            \u003cbutton type=\"submit\" class=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\"\u003ePublish\u003c/button\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                    \u003cdiv id=\"editor-status\" class=\"text-sm text-gray-500 h-4\"\u003e\u003c/div\u003e\n                \u003c/form\u003e\n            \u003c/div\u003e\n        `;\n\n        const form = container.querySelector('#blog-editor-form');\n        const markdownInput = container.querySelector('#post-content-md');\n        const previewOutput = container.querySelector('#post-preview');\n        const statusDiv = container.querySelector('#editor-status');\n        const saveDraftBtn = container.querySelector('#save-draft-btn');\n\n        const updatePreview = () =\u003e {\n            const markdownText = markdownInput.value;\n            previewOutput.innerHTML = parseMarkdown(markdownText);\n        };\n\n        const handleAutosave = () =\u003e {\n            clearTimeout(autosaveTimeout);\n            autosaveTimeout = setTimeout(() =\u003e {\n                statusDiv.textContent = `Autosaved at ${new Date().toLocaleTimeString()}`;\n            }, 2000);\n        };\n\n        markdownInput.addEventListener('input', () =\u003e {\n            updatePreview();\n            handleAutosave();\n        });\n\n        const handleSubmit = async (isPublic) =\u003e {\n            const formData = new FormData(form);\n            const postData = {\n                title: formData.get('title'),\n                contentMd: formData.get('contentMd'),\n                isPublic: isPublic,\n            };\n\n            if (!postData.title || !postData.contentMd) {\n                statusDiv.textContent = 'Title and Content are required.';\n                return;\n            }\n\n            try {\n                statusDiv.textContent = 'Saving...';\n                await BlogService.createPost(postData);\n                statusDiv.textContent = 'Saved successfully!';\n                navigate('/blog');\n            } catch (error) {\n                statusDiv.textContent = `Error: ${error.message}`;\n            }\n        };\n\n        form.addEventListener('submit', (e) =\u003e {\n            e.preventDefault();\n            const isPublicCheckbox = container.querySelector('#is-public');\n            handleSubmit(isPublicCheckbox.checked);\n        });\n\n        saveDraftBtn.addEventListener('click', () =\u003e {\n            handleSubmit(false); // Save as draft\n        });\n\n        updatePreview(); // Initial render\n    }\n};\n```",
  "client/js/views/profile/ProfileView.js": "import { UserService } from '../../services/userService.js';\nimport { BlogPostCard } from '../../components/BlogPostCard.js';\nimport { getUser, isLoggedIn } from '../../state/authState.js';\n\nexport const ProfileView = {\n    render: async (container, params) =\u003e {\n        container.innerHTML = `\u003cp class=\"text-center mt-8\"\u003eLoading profile...\u003c/p\u003e`;\n        const { username } = params;\n        const loggedInUser = getUser();\n\n        try {\n            const profile = await UserService.getProfile(username);\n            const { user, posts, isFollowing, followerCount, followingCount } = profile;\n\n            let followButton = '';\n            if (isLoggedIn() \u0026\u0026 loggedInUser.id !== user.id) {\n                followButton = `\n                    \u003cbutton id=\"follow-btn\" class=\"px-4 py-2 text-sm font-medium rounded-md ${isFollowing ? 'bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200' : 'bg-blue-600 text-white hover:bg-blue-700'}\"\u003e\n                        ${isFollowing ? 'Unfollow' : 'Follow'}\n                    \u003c/button\u003e\n                `;\n            }\n\n            container.innerHTML = `\n                \u003cdiv class=\"max-w-4xl mx-auto p-4 sm:p-6 lg:p-8\"\u003e\n                    \u003cdiv class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-8\"\u003e\n                        \u003cdiv class=\"flex flex-col sm:flex-row items-center sm:items-start\"\u003e\n                            \u003cimg src=\"${user.avatar_url?.String || 'https://via.placeholder.com/150'}\" alt=\"${user.username}'s avatar\" class=\"w-24 h-24 rounded-full mb-4 sm:mb-0 sm:mr-6\"\u003e\n                            \u003cdiv class=\"flex-grow text-center sm:text-left\"\u003e\n                                \u003cdiv class=\"flex items-center justify-center sm:justify-between\"\u003e\n                                    \u003ch1 class=\"text-3xl font-bold\"\u003e${user.username}\u003c/h1\u003e\n                                    ${followButton}\n                                \u003c/div\u003e\n                                \u003cdiv class=\"flex justify-center sm:justify-start space-x-4 mt-2 text-gray-600 dark:text-gray-400\"\u003e\n                                    \u003cspan\u003e\u003cstrong\u003e${posts.length}\u003c/strong\u003e posts\u003c/span\u003e\n                                    \u003cspan\u003e\u003cstrong\u003e${followerCount}\u003c/strong\u003e followers\u003c/span\u003e\n                                    \u003cspan\u003e\u003cstrong\u003e${followingCount}\u003c/strong\u003e following\u003c/span\u003e\n                                \u003c/div\u003e\n                                \u003cp class=\"mt-4 text-gray-700 dark:text-gray-300\"\u003e${user.bio?.String || 'No bio provided.'}\u003c/p\u003e\n                            \u003c/div\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n\n                    \u003ch2 class=\"text-2xl font-bold mb-4\"\u003ePublic Posts\u003c/h2\u003e\n                    \u003cdiv id=\"posts-container\" class=\"grid grid-cols-1 md:grid-cols-2 gap-6\"\u003e\n                        ${posts.length \u003e 0 ? '' : '\u003cp\u003eThis user has no public posts.\u003c/p\u003e'}\n                    \u003c/div\u003e\n                \u003c/div\u003e\n            `;\n\n            const postsContainer = container.querySelector('#posts-container');\n            posts.forEach(post =\u003e {\n                postsContainer.appendChild(BlogPostCard(post));\n            });\n\n            const followBtn = container.querySelector('#follow-btn');\n            if (followBtn) {\n                followBtn.addEventListener('click', async () =\u003e {\n                    try {\n                        const currentActionIsFollow = !followBtn.textContent.trim().toLowerCase().includes('unfollow');\n                        if (currentActionIsFollow) {\n                            await UserService.follow(username);\n                            followBtn.textContent = 'Unfollow';\n                            followBtn.classList.remove('bg-blue-600', 'text-white', 'hover:bg-blue-700');\n                            followBtn.classList.add('bg-gray-200', 'dark:bg-gray-600', 'text-gray-800', 'dark:text-gray-200');\n                        } else {\n                            await UserService.unfollow(username);\n                            followBtn.textContent = 'Follow';\n                            followBtn.classList.remove('bg-gray-200', 'dark:bg-gray-600', 'text-gray-800', 'dark:text-gray-200');\n                            followBtn.classList.add('bg-blue-600', 'text-white', 'hover:bg-blue-700');\n                        }\n                        // Optionally re-fetch profile to update follower count, or update it manually\n                    } catch (error) {\n                        console.error('Failed to update follow status:', error);\n                        alert('Could not update follow status. Please try again.');\n                    }\n                });\n            }\n\n        } catch (error) {\n            container.innerHTML = `\u003cp class=\"text-center mt-8 text-red-500\"\u003eCould not load profile: ${error.message}\u003c/p\u003e`;\n        }\n    }\n};\n```",
  "cmd/server/main.go": "package main\n\nimport (\n\t\"database/sql\"\n\t\"errors\"\n\t\"fmt\"\n\t\"job-app-tracker/internal/handler\"\n\t\"job-app-tracker/internal/repository/postgres\"\n\t\"job-app-tracker/internal/usecase\"\n\t\"log\"\n\t\"os\"\n\n\t\"github.com/golang-migrate/migrate/v4\"\n\t_ \"github.com/golang-migrate/migrate/v4/database/postgres\"\n\t_ \"github.com/golang-migrate/migrate/v4/source/file\"\n\t_ \"github.com/lib/pq\" // Changed from pgx/v5/stdlib to lib/pq\n\t\"github.com/jmoiron/sqlx\"\n\t\"github.com/joho/godotenv\"\n)\n\nfunc main() {\n\terr := godotenv.Load()\n\tif err != nil {\n\t\tlog.Println(\"No .env file found, using environment variables\")\n\t}\n\n\tdatabaseURL := os.Getenv(\"DATABASE_URL\")\n\tif databaseURL == \"\" {\n\t\tlog.Fatal(\"DATABASE_URL is not set\")\n\t}\n\n\trunMigrations(databaseURL)\n\n\tdb, err := sqlx.Connect(\"postgres\", databaseURL) // Changed from \"pgx\" to \"postgres\"\n\tif err != nil {\n\t\tlog.Fatalf(\"Unable to connect to database: %v\\n\", err)\n\t}\n\tdefer db.Close()\n\n\t// Repositories\n\tuserRepo := postgres.NewPostgresUserRepository(db)\n\tcompanyRepo := postgres.NewPostgresCompanyRepository(db)\n\troleRepo := postgres.NewPostgresRoleRepository(db)\n\tappRepo := postgres.NewPostgresApplicationRepository(db) // Kept original name for ApplicationRepository\n\tblogRepo := postgres.NewPostgresBlogPostRepository(db)\n\tcommentRepo := postgres.NewPostgresCommentRepository(db)\n\tlikeRepo := postgres.NewPostgresLikeRepository(db)\n\tfollowRepo := postgres.NewPostgresFollowRepository(db) // Added from attempted\n\n\t// Use Cases\n\tuserUC := usecase.NewUserService(userRepo, blogRepo, followRepo) // Updated dependencies\n\tappUC := usecase.NewApplicationService(appRepo, companyRepo, roleRepo)\n\tblogUC := usecase.NewBlogService(blogRepo, commentRepo, likeRepo)\n\n\t// Router\n\trouter := handler.NewRouter(userUC, appUC, blogUC) // Changed variable name to router\n\n\tport := os.Getenv(\"PORT\")\n\tif port == \"\" {\n\t\tport = \"8080\"\n\t}\n\n\tlog.Printf(\"Server starting on port %s\", port)\n\tif err := router.Start(\":\" + port); err != nil { // Changed variable name to router\n\t\tlog.Fatalf(\"Failed to start server: %v\", err)\n\t}\n}\n\nfunc runMigrations(databaseURL string) {\n\tif databaseURL == \"\" {\n\t\tlog.Fatal(\"Cannot run migrations: DATABASE_URL is not set\")\n\t}\n\n\t// The pgx driver used by sqlx uses a different DSN format than what migrate expects.\n\t// We need to ensure the DSN is in the format: postgresql://user:password@host:port/dbname?sslmode=disable\n\t// The connection string for pgx is usually in this format already.\n\tm, err := migrate.New(\"file://migrations\", databaseURL)\n\tif err != nil {\n\t\tlog.Fatalf(\"Could not create migrate instance: %v\", err)\n\t}\n\n\tif err := m.Up(); err != nil {\n\t\tif errors.Is(err, migrate.ErrNoChange) { // Kept errors.Is for robustness\n\t\t\tlog.Println(\"No new migrations to apply.\")\n\t\t} else {\n\t\t\tlog.Fatalf(\"Could not run migrations: %v\", err)\n\t\t}\n\t} else {\n\t\tlog.Println(\"Migrations applied successfully.\")\n\t}\n}\n",
  "go.mod": "module job-app-tracker\n\ngo 1.21\n\nrequire (\n\tgithub.com/golang-jwt/jwt/v5 v5.2.1\n\tgithub.com/golang-migrate/migrate/v4 v4.17.1\n\tgithub.com/jackc/pgx/v5 v5.6.0\n\tgithub.com/jmoiron/sqlx v1.4.0\n\tgithub.com/joho/godotenv v1.5.1\n\tgithub.com/labstack/echo/v4 v4.12.0\n\tgolang.org/x/crypto v0.22.0\n)\n\nrequire (\n\tgithub.com/golang-jwt/jwt v3.2.2+incompatible // indirect\n\tgithub.com/hashicorp/errwrap v1.1.0 // indirect\n\tgithub.com/hashicorp/go-multierror v1.1.1 // indirect\n\tgithub.com/jackc/pgpassfile v1.0.0 // indirect\n\tgithub.com/jackc/pgservicefile v0.0.0-20221227161230-091c0ba34f0a // indirect\n\tgithub.com/jackc/puddle/v2 v2.2.1 // indirect\n\tgithub.com/labstack/gommon v0.4.2 // indirect\n\tgithub.com/lib/pq v1.10.9 // indirect\n\tgithub.com/mattn/go-colorable v0.1.13 // indirect\n\tgithub.com/mattn/go-isatty v0.0.20 // indirect\n\tgithub.com/valyala/bytebufferpool v1.0.0 // indirect\n\tgithub.com/valyala/fasttemplate v1.2.2 // indirect\n\tgo.uber.org/atomic v1.7.0 // indirect\n\tgolang.org/x/net v0.24.0 // indirect\n\tgolang.org/x/sync v0.1.0 // indirect\n\tgolang.org/x/sys v0.19.0 // indirect\n\tgolang.org/x/text v0.14.0 // indirect\n\tgolang.org/x/time v0.5.0 // indirect\n)\n",
  "internal/domain/application.go": "package domain\n\nimport (\n\t\"database/sql\"\n\t\"encoding/json\"\n\t\"time\"\n)\n\ntype Company struct {\n\tID             int64\n\tName           string\n\tNormalizedName string\n\tMetadata       json.RawMessage // JSON or JSONB\n}\n\ntype Role struct {\n\tID        int64\n\tCompanyID int64\n\tTitle     string\n\tMetadata  json.RawMessage // JSON or JSONB\n}\n\ntype Application struct {\n\tID            int64\n\tUserID        int64\n\tCompanyID     int64\n\tRoleID        int64\n\tDateApplied   time.Time\n\tStatus        string\n\tMetadata      json.RawMessage // JSON or JSONB\n\tCurrentNoteID sql.NullInt64\n}\n\ntype ApplicationNote struct {\n\tID            int64\n\tApplicationID int64\n\tUserID        int64\n\tTimestamp     time.Time\n\tContent       string\n}\n",
  "internal/domain/blog.go": "package domain\n\nimport (\n\t\"database/sql\"\n\t\"time\"\n\n\t\"github.com/lib/pq\"\n)\n\n// BlogPost represents a published blog post.\ntype BlogPost struct {\n\tID                 int64          `db:\"id\" json:\"id\"`\n\tUserID             int64          `db:\"user_id\" json:\"userId\"`\n\tTitle              string         `db:\"title\" json:\"title\"`\n\tSlug               string         `db:\"slug\" json:\"slug\"`\n\tContentMD          string         `db:\"content_md\" json:\"contentMd\"`\n\tContentHTML        string         `db:\"content_html\" json:\"contentHtml\"`\n\tExcerpt            sql.NullString `db:\"excerpt\" json:\"excerpt\"`\n\tIsPublic           bool           `db:\"is_public\" json:\"isPublic\"`\n\tCreatedAt          time.Time      `db:\"created_at\" json:\"createdAt\"`\n\tUpdatedAt          time.Time      `db:\"updated_at\" json:\"updatedAt\"`\n\tSEOMetaTitle       sql.NullString `db:\"seo_meta_title\" json:\"seoMetaTitle\"`\n\tSEOMetaDescription sql.NullString `db:\"seo_meta_description\" json:\"seoMetaDescription\"`\n\tTags               pq.StringArray `db:\"tags\" json:\"tags\"`\n\tUsername           string         `db:\"username\" json:\"username\"` // For joining user data\n}\n\ntype DraftVersion struct {\n\tID                 int64\n\tPostID             sql.NullInt64 // Null for brand new drafts\n\tUserID             int64\n\tContentMD          string\n\tContentHTML        string\n\tLastSavedAt        time.Time\n\tIsPublishedVersion bool\n}\n",
  "internal/domain/common.go": "package domain\n\n// ListParams holds parameters for filtering, sorting, and pagination.\ntype ListParams struct {\n\tPage      int\n\tLimit     int\n\tSortBy    string\n\tSortOrder string\n\tSearch    string\n\tFilters   map[string]string\n}\n\n// Pagination holds metadata for paginated results.\ntype Pagination struct {\n\tTotalItems  int64 `json:\"totalItems\"`\n\tTotalPages  int   `json:\"totalPages\"`\n\tCurrentPage int   `json:\"currentPage\"`\n\tPageSize    int   `json:\"pageSize\"`\n}\n\n// PaginatedApplications is a container for paginated application results.\ntype PaginatedApplications struct {\n\tApplications []Application `json:\"applications\"`\n\tPagination   Pagination    `json:\"pagination\"`\n}\n\n// PaginatedBlogPosts is a container for paginated blog post results.\ntype PaginatedBlogPosts struct {\n\tBlogPosts  []BlogPost `json:\"posts\"`\n\tPagination Pagination `json:\"pagination\"`\n}\n",
  "internal/domain/social.go": "package domain\n\nimport (\n\t\"database/sql\"\n\t\"time\"\n)\n\ntype ContentType string\n\nconst (\n\tContentTypePost    ContentType = \"post\"\n\tContentTypeComment ContentType = \"comment\"\n)\n\ntype Comment struct {\n\tID              int64          `db:\"id\" json:\"id\"`\n\tPostID          int64          `db:\"post_id\" json:\"post_id\"`\n\tUserID          int64          `db:\"user_id\" json:\"user_id\"`\n\tParentCommentID sql.NullInt64  `db:\"parent_comment_id\" json:\"parent_comment_id\"`\n\tContentMD       string         `db:\"content_md\" json:\"content_md\"`\n\tContentHTML     string         `db:\"content_html\" json:\"content_html\"`\n\tCreatedAt       time.Time      `db:\"created_at\" json:\"created_at\"`\n\tUpdatedAt       time.Time      `db:\"updated_at\" json:\"updated_at\"`\n\tDepthLevel      int            `db:\"depth_level\" json:\"depth_level\"`\n\tUsername        sql.NullString `db:\"username\" json:\"username,omitempty\"` // From JOIN\n\tReplies         []*Comment     `db:\"-\" json:\"replies,omitempty\"`         // For nesting in response\n}\n\ntype Like struct {\n\tID          int64       `db:\"id\" json:\"id\"`\n\tUserID      int64       `db:\"user_id\" json:\"user_id\"`\n\tContentType ContentType `db:\"content_type\" json:\"content_type\"`\n\tContentID   int64       `db:\"content_id\" json:\"content_id\"`\n\tCreatedAt   time.Time   `db:\"created_at\" json:\"created_at\"`\n}\n\ntype Follow struct {\n\tID             int64     `db:\"id\" json:\"id\"`\n\tFollowerUserID int64     `db:\"follower_user_id\" json:\"follower_user_id\"`\n\tFolloweeUserID int64     `db:\"followee_user_id\" json:\"followee_user_id\"`\n\tCreatedAt      time.Time `db:\"created_at\" json:\"created_at\"`\n}",
  "internal/domain/user.go": "package domain\n\nimport (\n\t\"database/sql\"\n\t\"encoding/json\"\n\t\"time\"\n)\n\ntype User struct {\n\tID             int64           `db:\"id\"`\n\tUsername       string          `db:\"username\"`\n\tEmail          string          `db:\"email\"`\n\tHashedPassword string          `db:\"hashed_password\"`\n\tBio            sql.NullString  `db:\"bio\"`\n\tAvatarURL      sql.NullString  `db:\"avatar_url\"`\n\tSettings       json.RawMessage `db:\"settings\"`\n\tCreatedAt      time.Time       `db:\"created_at\"`\n\tUpdatedAt      time.Time       `db:\"updated_at\"`\n}\n",
  "internal/handler/application_handler.go": "package handler\n\nimport (\n\t\"job-app-tracker/internal/domain\"\n\t\"job-app-tracker/internal/usecase\"\n\t\"net/http\"\n\t\"strconv\"\n\n\t\"github.com/labstack/echo/v4\"\n)\n\ntype ApplicationHandler struct {\n\tappUseCase usecase.ApplicationUseCase\n}\n\nfunc NewApplicationHandler(uc usecase.ApplicationUseCase) *ApplicationHandler {\n\treturn \u0026ApplicationHandler{appUseCase: uc}\n}\n\ntype createApplicationRequest struct {\n\tCompanyName string `json:\"companyName\"`\n\tRoleTitle   string `json:\"roleTitle\"`\n\tStatus      string `json:\"status\"`\n\tDateApplied string `json:\"dateApplied\"`\n}\n\nfunc (h *ApplicationHandler) CreateApplication(c echo.Context) error {\n\tuserID := c.Get(\"userID\").(int64)\n\treq := new(createApplicationRequest)\n\tif err := c.Bind(req); err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"message\": \"Invalid request body\"})\n\t}\n\n\tapp, err := h.appUseCase.CreateApplication(userID, req.CompanyName, req.RoleTitle, req.Status, req.DateApplied)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusInternalServerError, map[string]string{\"message\": err.Error()})\n\t}\n\n\treturn c.JSON(http.StatusCreated, app)\n}\n\nfunc (h *ApplicationHandler) GetApplications(c echo.Context) error {\n\tuserID := c.Get(\"userID\").(int64)\n\n\tpage, _ := strconv.Atoi(c.QueryParam(\"page\"))\n\tlimit, _ := strconv.Atoi(c.QueryParam(\"limit\"))\n\n\tparams := domain.ListParams{\n\t\tPage:      page,\n\t\tLimit:     limit,\n\t\tSortBy:    c.QueryParam(\"sortBy\"),\n\t\tSortOrder: c.QueryParam(\"sortOrder\"),\n\t\tSearch:    c.QueryParam(\"search\"),\n\t\tFilters:   make(map[string]string),\n\t}\n\tif status := c.QueryParam(\"status\"); status != \"\" {\n\t\tparams.Filters[\"status\"] = status\n\t}\n\n\tpaginatedApps, err := h.appUseCase.GetApplications(userID, params)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusInternalServerError, map[string]string{\"message\": \"Failed to retrieve applications\"})\n\t}\n\n\treturn c.JSON(http.StatusOK, paginatedApps)\n}\n\nfunc (h *ApplicationHandler) GetApplicationByID(c echo.Context) error {\n\tuserID := c.Get(\"userID\").(int64)\n\tid, err := strconv.ParseInt(c.Param(\"id\"), 10, 64)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"message\": \"Invalid application ID\"})\n\t}\n\n\tapp, err := h.appUseCase.GetApplicationByID(id, userID)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusInternalServerError, map[string]string{\"message\": err.Error()})\n\t}\n\tif app == nil {\n\t\treturn c.JSON(http.StatusNotFound, map[string]string{\"message\": \"Application not found\"})\n\t}\n\n\treturn c.JSON(http.StatusOK, app)\n}\n\nfunc (h *ApplicationHandler) UpdateApplication(c echo.Context) error {\n\tuserID := c.Get(\"userID\").(int64)\n\tid, err := strconv.ParseInt(c.Param(\"id\"), 10, 64)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"message\": \"Invalid application ID\"})\n\t}\n\n\treq := new(createApplicationRequest)\n\tif err := c.Bind(req); err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"message\": \"Invalid request body\"})\n\t}\n\n\tapp, err := h.appUseCase.UpdateApplication(id, userID, req.CompanyName, req.RoleTitle, req.Status, req.DateApplied)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusInternalServerError, map[string]string{\"message\": err.Error()})\n\t}\n\n\treturn c.JSON(http.StatusOK, app)\n}\n\nfunc (h *ApplicationHandler) DeleteApplication(c echo.Context) error {\n\tuserID := c.Get(\"userID\").(int64)\n\tid, err := strconv.ParseInt(c.Param(\"id\"), 10, 64)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"message\": \"Invalid application ID\"})\n\t}\n\n\tif err := h.appUseCase.DeleteApplication(id, userID); err != nil {\n\t\treturn c.JSON(http.StatusInternalServerError, map[string]string{\"message\": err.Error()})\n\t}\n\n\treturn c.NoContent(http.StatusNoContent)\n}\n",
  "internal/handler/auth_handler.go": "package handler\n\nimport (\n\t\"job-app-tracker/internal/usecase\"\n\t\"net/http\"\n\n\t\"github.com/labstack/echo/v4\"\n)\n\ntype AuthHandler struct {\n\tuserUseCase usecase.UserUseCase\n}\n\nfunc NewAuthHandler(uc usecase.UserUseCase) *AuthHandler {\n\treturn \u0026AuthHandler{userUseCase: uc}\n}\n\ntype RegisterRequest struct {\n\tUsername string `json:\"username\"`\n\tEmail    string `json:\"email\"`\n\tPassword string `json:\"password\"`\n}\n\ntype LoginRequest struct {\n\tEmail    string `json:\"email\"`\n\tPassword string `json:\"password\"`\n}\n\nfunc (h *AuthHandler) Register(c echo.Context) error {\n\tvar req RegisterRequest\n\tif err := c.Bind(\u0026req); err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"message\": \"Invalid request body\"}) // Changed error message key\n\t}\n\n\tuser, err := h.userUseCase.Register(req.Username, req.Email, req.Password)\n\tif err != nil {\n\t\t// Kept StatusConflict as it's more appropriate for user already exists\n\t\treturn c.JSON(http.StatusConflict, map[string]string{\"message\": err.Error()}) // Changed error message key\n\t}\n\n\t// Don't send password back\n\tuser.HashedPassword = \"\"\n\n\treturn c.JSON(http.StatusCreated, user)\n}\n\nfunc (h *AuthHandler) Login(c echo.Context) error {\n\tvar req LoginRequest\n\tif err := c.Bind(\u0026req); err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"message\": \"Invalid request body\"}) // Changed error message key\n\t}\n\n\tuser, token, err := h.userUseCase.Login(req.Email, req.Password) // Updated return signature\n\tif err != nil {\n\t\treturn c.JSON(http.StatusUnauthorized, map[string]string{\"message\": err.Error()}) // Changed error message key and content\n\t}\n\n\tuser.HashedPassword = \"\" // Added for consistency\n\treturn c.JSON(http.StatusOK, map[string]interface{}{ // Updated return type to include user\n\t\t\"token\": token,\n\t\t\"user\":  user,\n\t})\n}\n",
  "internal/handler/blog_handler.go": "package handler\n\nimport (\n\t\"fmt\"\n\t\"job-app-tracker/internal/domain\"\n\t\"job-app-tracker/internal/usecase\"\n\t\"net/http\"\n\t\"strconv\"\n\n\t\"github.com/labstack/echo/v4\"\n\t\"github.com/russross/blackfriday/v2\"\n)\n\ntype BlogHandler struct {\n\tblogUseCase usecase.BlogUseCase\n}\n\ntype createPostRequest struct {\n\tTitle     string `json:\"title\"`\n\tContentMD string `json:\"contentMd\"`\n\tIsPublic  bool   `json:\"isPublic\"`\n}\n\ntype addCommentRequest struct {\n\tContentMD       string `json:\"contentMd\"`\n\tParentCommentID *int64 `json:\"parentCommentId\"`\n}\n\ntype toggleLikeRequest struct {\n\tContentType domain.ContentType `json:\"contentType\"`\n\tContentID   int64              `json:\"contentId\"`\n}\n\nfunc NewBlogHandler(uc usecase.BlogUseCase) *BlogHandler {\n\treturn \u0026BlogHandler{blogUseCase: uc}\n}\n\nfunc (h *BlogHandler) CreatePost(c echo.Context) error {\n\tuserID := c.Get(\"userID\").(int64)\n\treq := new(createPostRequest)\n\tif err := c.Bind(req); err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"message\": \"Invalid request body\"})\n\t}\n\n\t// Convert Markdown to HTML on the server\n\thtml := blackfriday.Run([]byte(req.ContentMD))\n\n\tpost, err := h.blogUseCase.CreatePost(userID, req.Title, req.ContentMD, string(html), req.IsPublic)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusInternalServerError, map[string]string{\"message\": err.Error()})\n\t}\n\n\treturn c.JSON(http.StatusCreated, post)\n}\n\nfunc (h *BlogHandler) GetPublicPost(c echo.Context) error {\n\tusername := c.Param(\"username\")\n\tslug := c.Param(\"slug\")\n\n\tpost, err := h.blogUseCase.GetPublicPost(username, slug)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusInternalServerError, map[string]string{\"message\": err.Error()})\n\t}\n\tif post == nil {\n\t\treturn c.JSON(http.StatusNotFound, map[string]string{\"message\": \"Post not found\"})\n\t}\n\n\treturn c.JSON(http.StatusOK, post)\n}\n\nfunc (h *BlogHandler) GetPublicPosts(c echo.Context) error {\n\tpage, _ := strconv.Atoi(c.QueryParam(\"page\"))\n\tlimit, _ := strconv.Atoi(c.QueryParam(\"limit\"))\n\n\tparams := domain.ListParams{\n\t\tPage:      page,\n\t\tLimit:     limit,\n\t\tSortBy:    c.QueryParam(\"sortBy\"),\n\t\tSortOrder: c.QueryParam(\"sortOrder\"),\n\t\tSearch:    c.QueryParam(\"search\"),\n\t}\n\n\tpaginatedPosts, err := h.blogUseCase.GetPublicPosts(params)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusInternalServerError, map[string]string{\"message\": \"Failed to retrieve posts\"})\n\t}\n\treturn c.JSON(http.StatusOK, paginatedPosts)\n}\n\nfunc (h *BlogHandler) AddComment(c echo.Context) error {\n\tuserID := c.Get(\"userID\").(int64)\n\tusername := c.Get(\"username\").(string)\n\tpostID, err := strconv.ParseInt(c.Param(\"postID\"), 10, 64)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"message\": \"Invalid post ID\"})\n\t}\n\n\treq := new(addCommentRequest)\n\tif err := c.Bind(req); err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"message\": \"Invalid request body\"})\n\t}\n\n\thtml := blackfriday.Run([]byte(req.ContentMD))\n\n\tcomment, err := h.blogUseCase.AddComment(postID, userID, req.ParentCommentID, req.ContentMD, string(html))\n\tif err != nil {\n\t\treturn c.JSON(http.StatusInternalServerError, map[string]string{\"message\": err.Error()})\n\t}\n\n\tcomment.Username.String = username\n\treturn c.JSON(http.StatusCreated, comment)\n}\n\nfunc (h *BlogHandler) GetCommentsForPost(c echo.Context) error {\n\tpostID, err := strconv.ParseInt(c.Param(\"postID\"), 10, 64)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"message\": \"Invalid post ID\"})\n\t}\n\n\tcomments, err := h.blogUseCase.GetCommentsForPost(postID)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusInternalServerError, map[string]string{\"message\": err.Error()})\n\t}\n\n\treturn c.JSON(http.StatusOK, comments)\n}\n\nfunc (h *BlogHandler) ToggleLike(c echo.Context) error {\n\tuserID := c.Get(\"userID\").(int64)\n\treq := new(toggleLikeRequest)\n\tif err := c.Bind(req); err != nil {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"message\": \"Invalid request body\"})\n\t}\n\n\tif req.ContentType != domain.ContentTypePost \u0026\u0026 req.ContentType != domain.ContentTypeComment {\n\t\treturn c.JSON(http.StatusBadRequest, map[string]string{\"message\": \"Invalid content type\"})\n\t}\n\n\tisLiked, err := h.blogUseCase.ToggleLike(userID, req.ContentType, req.ContentID)\n\tif err != nil {\n\t\treturn c.JSON(http.StatusInternalServerError, map[string]string{\"message\": err.Error()})\n\t}\n\n\treturn c.JSON(http.StatusOK, map[string]bool{\"isLiked\": isLiked})\n}\n",
  "internal/handler/middleware.go": "package handler\n\nimport (\n\t\"job-app-tracker/pkg/util\"\n\t\"net/http\"\n\t\"strings\"\n\n\t\"github.com/labstack/echo/v4\"\n)\n\nfunc AuthMiddleware(next echo.HandlerFunc) echo.HandlerFunc {\n\treturn func(c echo.Context) error {\n\t\tauthHeader := c.Request().Header.Get(\"Authorization\")\n\t\tif authHeader == \"\" {\n\t\t\treturn c.JSON(http.StatusUnauthorized, map[string]string{\"error\": \"Missing authorization header\"})\n\t\t}\n\n\t\tparts := strings.Split(authHeader, \" \")\n\t\tif len(parts) != 2 || strings.ToLower(parts[0]) != \"bearer\" {\n\t\t\treturn c.JSON(http.StatusUnauthorized, map[string]string{\"error\": \"Invalid authorization header format\"})\n\t\t}\n\n\t\ttokenStr := parts[1]\n\t\tclaims, err := util.ValidateJWT(tokenStr)\n\t\tif err != nil {\n\t\t\treturn c.JSON(http.StatusUnauthorized, map[string]string{\"error\": \"Invalid token\"})\n\t\t}\n\n\t\tc.Set(\"userID\", claims.UserID)\n\t\tc.Set(\"username\", claims.Username)\n\n\t\treturn next(c)\n\t}\n}\n",
  "internal/handler/router.go": "package handler\n\nimport (\n\t\"job-app-tracker/internal/usecase\"\n\t\"net/http\"\n\t\"strings\" // Added from attempted\n\n\t\"github.com/labstack/echo/v4\"\n\t\"github.com/labstack/echo/v4/middleware\"\n)\n\nfunc NewRouter(userUC usecase.UserUseCase, appUC usecase.ApplicationUseCase, blogUC usecase.BlogUseCase) *echo.Echo {\n\te := echo.New()\n\n\t// Middleware\n\te.Use(middleware.Logger())\n\te.Use(middleware.Recover())\n\n\t// Serve static files for the frontend\n\te.Static(\"/\", \"client\")\n\n\t// API routes\n\tapi := e.Group(\"/api\") // Changed variable name to api\n\n\t// Handlers\n\tauthHandler := NewAuthHandler(userUC)\n\tappHandler := NewApplicationHandler(appUC)\n\tblogHandler := NewBlogHandler(blogUC)\n\tuserHandler := NewUserHandler(userUC) // Added from attempted\n\n\t// Auth routes\n\tauthGroup := api.Group(\"/auth\")\n\tauthGroup.POST(\"/register\", authHandler.Register)\n\tauthGroup.POST(\"/login\", authHandler.Login)\n\n\t// User routes (Added from attempted)\n\tuserGroup := api.Group(\"/users\")\n\tuserGroup.GET(\"/:username/profile\", userHandler.GetProfile, AuthMiddleware) // Auth is optional here, handled in handler\n\tuserGroup.POST(\"/:username/follow\", userHandler.FollowUser, AuthMiddleware)\n\tuserGroup.DELETE(\"/:username/follow\", userHandler.UnfollowUser, AuthMiddleware)\n\n\t// Application routes (protected)\n\tappGroup := api.Group(\"/applications\", AuthMiddleware)\n\tappGroup.POST(\"\", appHandler.CreateApplication)\n\tappGroup.GET(\"\", appHandler.GetApplications)\n\tappGroup.GET(\"/:id\", appHandler.GetApplicationByID)\n\tappGroup.PUT(\"/:id\", appHandler.UpdateApplication)\n\tappGroup.DELETE(\"/:id\", appHandler.DeleteApplication)\n\n\t// Blog routes\n\tblogGroup := api.Group(\"/blog\")\n\tblogPostsGroup := blogGroup.Group(\"/posts\") // Refactored blog routes\n\n\t// Public blog routes\n\tblogPostsGroup.GET(\"\", blogHandler.GetPublicPosts)\n\tblogPostsGroup.GET(\"/:username/:slug\", blogHandler.GetPublicPost)\n\tblogPostsGroup.GET(\"/:postID/comments\", blogHandler.GetCommentsForPost)\n\n\t// Authenticated blog routes\n\tblogPostsGroup.POST(\"\", blogHandler.CreatePost, AuthMiddleware)           // Added AuthMiddleware\n\tblogPostsGroup.POST(\"/:postID/comments\", blogHandler.AddComment, AuthMiddleware) // Added AuthMiddleware\n\tblogGroup.POST(\"/like\", blogHandler.ToggleLike, AuthMiddleware)           // Added AuthMiddleware\n\n\t// SPA Fallback - This should be the last route (Adopted attempted's cleaner approach)\n\te.GET(\"/*\", func(c echo.Context) error {\n\t\t// Don't fallback for API routes\n\t\tif strings.HasPrefix(c.Request().URL.Path, \"/api/\") {\n\t\t\treturn echo.NewHTTPError(http.StatusNotFound, \"API route not found\")\n\t\t}\n\t\treturn c.File(\"client/index.html\")\n\t})\n\n\treturn e\n}\n",
  "internal/handler/user_handler.go": "package handler\n\nimport (\n\t\"net/http\"\n\n\t\"github.com/golang-jwt/jwt/v5\"\n\t\"github.com/labstack/echo/v4\"\n\t\"job-app-tracker/internal/usecase\"\n)\n\ntype UserHandler struct {\n\tuserUseCase usecase.UserUseCase\n}\n\nfunc NewUserHandler(uc usecase.UserUseCase) *UserHandler {\n\treturn \u0026UserHandler{userUseCase: uc}\n}\n\nfunc (h *UserHandler) GetProfile(c echo.Context) error {\n\tusername := c.Param(\"username\")\n\n\t// Viewer ID is optional (for non-logged-in users)\n\tvar viewerID int64\n\tuserToken, ok := c.Get(\"user\").(*jwt.Token)\n\tif ok {\n\t\tclaims := userToken.Claims.(*Claims)\n\t\tviewerID = claims.UserID\n\t}\n\n\tprofile, err := h.userUseCase.GetProfile(username, viewerID)\n\tif err != nil {\n\t\t// Handle \"not found\" specifically if the use case returns a sentinel error\n\t\treturn c.JSON(http.StatusNotFound, map[string]string{\"message\": \"User not found\"})\n\t}\n\n\treturn c.JSON(http.StatusOK, profile)\n}\n\nfunc (h *UserHandler) FollowUser(c echo.Context) error {\n\tfolloweeUsername := c.Param(\"username\")\n\tfollowerID := c.Get(\"userID\").(int64)\n\n\tif err := h.userUseCase.FollowUser(followerID, followeeUsername); err != nil {\n\t\treturn c.JSON(http.StatusInternalServerError, map[string]string{\"message\": err.Error()})\n\t}\n\n\treturn c.NoContent(http.StatusCreated)\n}\n\nfunc (h *UserHandler) UnfollowUser(c echo.Context) error {\n\tfolloweeUsername := c.Param(\"username\")\n\tfollowerID := c.Get(\"userID\").(int64)\n\n\tif err := h.userUseCase.UnfollowUser(followerID, followeeUsername); err != nil {\n\t\treturn c.JSON(http.StatusInternalServerError, map[string]string{\"message\": err.Error()})\n\t}\n\n\treturn c.NoContent(http.StatusNoContent)\n}\n",
  "internal/repository/interfaces.go": "package repository\n\nimport \"job-app-tracker/internal/domain\"\n\ntype UserRepository interface {\n\tCreate(user *domain.User) error\n\tGetByEmail(email string) (*domain.User, error)\n\tGetByUsername(username string) (*domain.User, error)\n\tGetByID(id int64) (*domain.User, error)\n}\n\ntype CompanyRepository interface {\n\tFindOrCreate(company *domain.Company) error\n}\n\ntype RoleRepository interface {\n\tFindOrCreate(role *domain.Role) error\n}\n\ntype ApplicationRepository interface {\n\tCreate(app *domain.Application) error\n\tGetByID(id int64, userID int64) (*domain.Application, error)\n\tGetApplications(userID int64, params domain.ListParams) (*domain.PaginatedApplications, error)\n\tUpdate(app *domain.Application) error\n\tDelete(id int64, userID int64) error\n}\n\ntype ApplicationNoteRepository interface {\n\tCreate(note *domain.ApplicationNote) error\n\tGetAllForApplication(appID int64, userID int64) ([]domain.ApplicationNote, error)\n}\n\ntype BlogPostRepository interface {\n\tCreate(post *domain.BlogPost) error\n\tGetBySlugAndUser(slug string, username string) (*domain.BlogPost, error)\n\tGetPublicPosts(params domain.ListParams) (*domain.PaginatedBlogPosts, error)\n\tGetPublicPostsByUserID(userID int64) ([]domain.BlogPost, error)\n\tIsSlugTaken(slug string, userID int64) (bool, error)\n}\n\ntype CommentRepository interface {\n\tCreate(comment *domain.Comment) error\n\tGetByID(id int64) (*domain.Comment, error)\n\tGetForPost(postID int64) ([]domain.Comment, error)\n}\n\ntype LikeRepository interface {\n\tCreate(like *domain.Like) error\n\tDelete(userID int64, contentType domain.ContentType, contentID int64) error\n\tGet(userID int64, contentType domain.ContentType, contentID int64) (*domain.Like, error)\n}\n\ntype FollowRepository interface {\n\tCreate(follow *domain.Follow) error\n\tDelete(followerID, followeeID int64) error\n\tExists(followerID, followeeID int64) (bool, error)\n\tGetFollowerCount(userID int64) (int, error)\n\tGetFollowingCount(userID int64) (int, error)\n}\n",
  "internal/repository/postgres/application_repository.go": "package postgres\n\nimport (\n\t\"database/sql\"\n\t\"fmt\"\n\t\"job-app-tracker/internal/domain\"\n\t\"job-app-tracker/internal/repository\"\n\t\"math\"\n\t\"strings\"\n\n\t\"github.com/jmoiron/sqlx\"\n)\n\ntype postgresApplicationRepository struct {\n\tdb *sqlx.DB\n}\n\nfunc NewPostgresApplicationRepository(db *sqlx.DB) repository.CompanyRepository {\n\treturn \u0026postgresApplicationRepository{db: db}\n}\n\nfunc (r *postgresApplicationRepository) FindOrCreate(company *domain.Company) error {\n\tquery := `\n        WITH s AS (\n            SELECT id FROM companies WHERE normalized_name = $1\n        ), i AS (\n            INSERT INTO companies (name, normalized_name)\n            SELECT $2, $1\n            WHERE NOT EXISTS (SELECT 1 FROM s)\n            RETURNING id\n        )\n        SELECT id FROM i\n        UNION ALL\n        SELECT id FROM s\n    `\n\treturn r.db.QueryRow(query, company.NormalizedName, company.Name).Scan(\u0026company.ID)\n}\n\ntype postgresRoleRepository struct {\n\tdb *sqlx.DB\n}\n\nfunc NewPostgresRoleRepository(db *sqlx.DB) repository.RoleRepository {\n\treturn \u0026postgresRoleRepository{db: db}\n}\n\nfunc (r *postgresRoleRepository) FindOrCreate(role *domain.Role) error {\n\tquery := `\n        WITH s AS (\n            SELECT id FROM roles WHERE company_id = $1 AND title = $2\n        ), i AS (\n            INSERT INTO roles (company_id, title)\n            SELECT $1, $2\n            WHERE NOT EXISTS (SELECT 1 FROM s)\n            RETURNING id\n        )\n        SELECT id FROM i\n        UNION ALL\n        SELECT id FROM s\n    `\n\treturn r.db.QueryRow(query, role.CompanyID, role.Title).Scan(\u0026role.ID)\n}\n\ntype postgresAppRepo struct {\n\tdb *sqlx.DB\n}\n\nfunc NewPostgresAppRepository(db *sqlx.DB) repository.ApplicationRepository {\n\treturn \u0026postgresAppRepo{db: db}\n}\n\nfunc (r *postgresAppRepo) Create(app *domain.Application) error {\n\tquery := `\n        INSERT INTO applications (user_id, company_id, role_id, date_applied, status, metadata)\n        VALUES ($1, $2, $3, $4, $5, $6)\n        RETURNING id, created_at, updated_at`\n\treturn r.db.QueryRow(query, app.UserID, app.CompanyID, app.RoleID, app.DateApplied, app.Status, app.Metadata).Scan(\u0026app.ID, \u0026app.CreatedAt, \u0026app.UpdatedAt)\n}\n\nfunc (r *postgresAppRepo) GetByID(id int64, userID int64) (*domain.Application, error) {\n\tvar app domain.Application\n\tquery := `SELECT * FROM applications WHERE id = $1 AND user_id = $2`\n\terr := r.db.Get(\u0026app, query, id, userID)\n\tif err == sql.ErrNoRows {\n\t\treturn nil, nil\n\t}\n\treturn \u0026app, err\n}\n\nfunc (r *postgresAppRepo) GetApplications(userID int64, params domain.ListParams) (*domain.PaginatedApplications, error) {\n\tvar args []interface{}\n\tvar whereClauses []string\n\n\tbaseQuery := `\n\t\tSELECT a.id, a.user_id, a.company_id, a.role_id, a.date_applied, a.status, a.metadata, a.created_at, a.updated_at\n\t\tFROM applications a\n\t`\n\tcountBaseQuery := `SELECT COUNT(a.id) FROM applications a`\n\n\tjoinClause := \"\"\n\tneedsJoin := params.Search != \"\" || params.SortBy == \"company\" || params.SortBy == \"role\"\n\tif needsJoin {\n\t\tjoinClause = `\n\t\t\tJOIN companies c ON a.company_id = c.id\n\t\t\tJOIN roles r ON a.role_id = r.id\n\t\t`\n\t}\n\n\targs = append(args, userID)\n\twhereClauses = append(whereClauses, fmt.Sprintf(\"a.user_id = $%d\", len(args)))\n\n\tif params.Search != \"\" {\n\t\targs = append(args, \"%\"+strings.ToLower(params.Search)+\"%\")\n\t\tsearchClause := fmt.Sprintf(\"(LOWER(c.name) LIKE $%d OR LOWER(r.title) LIKE $%d)\", len(args), len(args))\n\t\twhereClauses = append(whereClauses, searchClause)\n\t}\n\n\tif status, ok := params.Filters[\"status\"]; ok \u0026\u0026 status != \"\" {\n\t\targs = append(args, status)\n\t\twhereClauses = append(whereClauses, fmt.Sprintf(\"a.status = $%d\", len(args)))\n\t}\n\n\twhereClauseStr := \"\"\n\tif len(whereClauses) \u003e 0 {\n\t\twhereClauseStr = \" WHERE \" + strings.Join(whereClauses, \" AND \")\n\t}\n\n\tcountQuery := countBaseQuery + joinClause + whereClauseStr\n\tvar totalItems int64\n\terr := r.db.Get(\u0026totalItems, countQuery, args...)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to count applications: %w\", err)\n\t}\n\n\tsortBy := \"a.date_applied\"\n\tswitch params.SortBy {\n\tcase \"company\":\n\t\tsortBy = \"c.name\"\n\tcase \"role\":\n\t\tsortBy = \"r.title\"\n\tcase \"status\":\n\t\tsortBy = \"a.status\"\n\t}\n\tsortOrder := \"DESC\"\n\tif strings.ToUpper(params.SortOrder) == \"ASC\" {\n\t\tsortOrder = \"ASC\"\n\t}\n\torderByClause := fmt.Sprintf(\" ORDER BY %s %s\", sortBy, sortOrder)\n\n\tlimit := params.Limit\n\tif limit \u003c= 0 {\n\t\tlimit = 10\n\t}\n\tpage := params.Page\n\tif page \u003c= 0 {\n\t\tpage = 1\n\t}\n\toffset := (page - 1) * limit\n\tpaginationClause := fmt.Sprintf(\" LIMIT %d OFFSET %d\", limit, offset)\n\n\tfinalQuery := baseQuery + joinClause + whereClauseStr + orderByClause + paginationClause\n\n\tvar apps []domain.Application\n\terr = r.db.Select(\u0026apps, finalQuery, args...)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to get applications: %w\", err)\n\t}\n\n\tpaginatedResult := \u0026domain.PaginatedApplications{\n\t\tApplications: apps,\n\t\tPagination: domain.Pagination{\n\t\t\tTotalItems:  totalItems,\n\t\t\tTotalPages:  int(math.Ceil(float64(totalItems) / float64(limit))),\n\t\t\tCurrentPage: page,\n\t\t\tPageSize:    limit,\n\t\t},\n\t}\n\n\treturn paginatedResult, nil\n}\n\nfunc (r *postgresAppRepo) Update(app *domain.Application) error {\n\tquery := `\n        UPDATE applications\n        SET company_id = $1, role_id = $2, date_applied = $3, status = $4, metadata = $5, updated_at = NOW()\n        WHERE id = $6 AND user_id = $7\n    `\n\t_, err := r.db.Exec(query, app.CompanyID, app.RoleID, app.DateApplied, app.Status, app.Metadata, app.ID, app.UserID)\n\treturn err\n}\n\nfunc (r *postgresAppRepo) Delete(id int64, userID int64) error {\n\tquery := `DELETE FROM applications WHERE id = $1 AND user_id = $2`\n\t_, err := r.db.Exec(query, id, userID)\n\treturn err\n}\n\ntype postgresAppNoteRepository struct {\n\tdb *sqlx.DB\n}\n\nfunc NewPostgresAppNoteRepository(db *sqlx.DB) repository.ApplicationNoteRepository {\n\treturn \u0026postgresAppNoteRepository{db: db}\n}\n\nfunc (r *postgresAppNoteRepository) Create(note *domain.ApplicationNote) error {\n\tquery := `\n        INSERT INTO application_notes (application_id, user_id, content)\n        VALUES ($1, $2, $3)\n        RETURNING id, created_at\n    `\n\treturn r.db.QueryRow(query, note.ApplicationID, note.UserID, note.Content).Scan(\u0026note.ID, \u0026note.Timestamp)\n}\n\nfunc (r *postgresAppNoteRepository) GetAllForApplication(appID int64, userID int64) ([]domain.ApplicationNote, error) {\n\tvar notes []domain.ApplicationNote\n\tquery := `\n        SELECT an.* FROM application_notes an\n        JOIN applications a ON an.application_id = a.id\n        WHERE an.application_id = $1 AND a.user_id = $2\n        ORDER BY an.created_at DESC\n    `\n\terr := r.db.Select(\u0026notes, query, appID, userID)\n\treturn notes, err\n}\n",
  "internal/repository/postgres/blog_repository.go": "package postgres\n\nimport (\n\t\"database/sql\"\n\t\"fmt\"\n\t\"job-app-tracker/internal/domain\"\n\t\"job-app-tracker/internal/repository\"\n\t\"math\"\n\t\"strings\"\n\n\t\"github.com/jmoiron/sqlx\"\n\t\"github.com/lib/pq\"\n)\n\ntype postgresBlogPostRepository struct {\n\tdb *sqlx.DB\n}\n\nfunc NewPostgresBlogPostRepository(db *sqlx.DB) repository.BlogPostRepository {\n\treturn \u0026postgresBlogPostRepository{db: db}\n}\n\nfunc (r *postgresBlogPostRepository) Create(post *domain.BlogPost) error {\n\tquery := `\n        INSERT INTO blog_posts (user_id, title, slug, content_md, content_html, excerpt, is_public, seo_meta_title, seo_meta_description, tags)\n        VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10)\n        RETURNING id, created_at, updated_at\n    `\n\treturn r.db.QueryRow(\n\t\tquery,\n\t\tpost.UserID, post.Title, post.Slug, post.ContentMD, post.ContentHTML, post.Excerpt, post.IsPublic,\n\t\tpost.SEOMetaTitle, post.SEOMetaDescription, pq.Array(post.Tags),\n\t).Scan(\u0026post.ID, \u0026post.CreatedAt, \u0026post.UpdatedAt)\n}\n\nfunc (r *postgresBlogPostRepository) GetBySlugAndUser(slug string, username string) (*domain.BlogPost, error) {\n\tvar post domain.BlogPost\n\tquery := `SELECT p.*, u.username FROM blog_posts p\n              JOIN users u ON p.user_id = u.id\n              WHERE p.slug = $1 AND u.username = $2`\n\terr := r.db.Get(\u0026post, query, slug, username)\n\tif err == sql.ErrNoRows {\n\t\treturn nil, nil\n\t}\n\treturn \u0026post, err\n}\n\nfunc (r *postgresBlogPostRepository) GetPublicPosts(params domain.ListParams) (*domain.PaginatedBlogPosts, error) {\n\tvar args []interface{}\n\tvar whereClauses []string\n\n\tbaseQuery := `\n\t\tSELECT p.id, p.user_id, p.title, p.slug, p.content_md, p.content_html, p.excerpt,\n\t\tp.is_public, p.created_at, p.updated_at, p.seo_meta_title, p.seo_meta_description, p.tags, u.username\n\t\tFROM blog_posts p\n\t\tJOIN users u ON p.user_id = u.id\n\t`\n\tcountBaseQuery := `SELECT COUNT(p.id) FROM blog_posts p`\n\n\twhereClauses = append(whereClauses, \"p.is_public = TRUE\")\n\n\tif params.Search != \"\" {\n\t\targs = append(args, \"%\"+strings.ToLower(params.Search)+\"%\")\n\t\tsearchClause := fmt.Sprintf(\"LOWER(p.title) LIKE $%d\", len(args))\n\t\twhereClauses = append(whereClauses, searchClause)\n\t}\n\n\twhereClauseStr := \"\"\n\tif len(whereClauses) \u003e 0 {\n\t\twhereClauseStr = \" WHERE \" + strings.Join(whereClauses, \" AND \")\n\t}\n\n\tcountQuery := countBaseQuery + whereClauseStr\n\tvar totalItems int64\n\terr := r.db.Get(\u0026totalItems, countQuery, args...)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to count blog posts: %w\", err)\n\t}\n\n\tsortBy := \"p.created_at\"\n\tif params.SortBy == \"title\" {\n\t\tsortBy = \"p.title\"\n\t}\n\tsortOrder := \"DESC\"\n\tif strings.ToUpper(params.SortOrder) == \"ASC\" {\n\t\tsortOrder = \"ASC\"\n\t}\n\torderByClause := fmt.Sprintf(\" ORDER BY %s %s\", sortBy, sortOrder)\n\n\tlimit := params.Limit\n\tif limit \u003c= 0 {\n\t\tlimit = 10\n\t}\n\tpage := params.Page\n\tif page \u003c= 0 {\n\t\tpage = 1\n\t}\n\toffset := (page - 1) * limit\n\tpaginationClause := fmt.Sprintf(\" LIMIT %d OFFSET %d\", limit, offset)\n\n\tfinalQuery := baseQuery + whereClauseStr + orderByClause + paginationClause\n\n\tvar posts []domain.BlogPost\n\terr = r.db.Select(\u0026posts, finalQuery, args...)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to get blog posts: %w\", err)\n\t}\n\n\tpaginatedResult := \u0026domain.PaginatedBlogPosts{\n\t\tBlogPosts: posts,\n\t\tPagination: domain.Pagination{\n\t\t\tTotalItems:  totalItems,\n\t\t\tTotalPages:  int(math.Ceil(float64(totalItems) / float64(limit))),\n\t\t\tCurrentPage: page,\n\t\t\tPageSize:    limit,\n\t\t},\n\t}\n\n\treturn paginatedResult, nil\n}\n\nfunc (r *postgresBlogPostRepository) GetPublicPostsByUserID(userID int64) ([]domain.BlogPost, error) {\n\tvar posts []domain.BlogPost\n\tquery := `SELECT p.*, u.username FROM blog_posts p\n\t\t\t  JOIN users u ON p.user_id = u.id\n\t\t\t  WHERE p.is_public = true AND p.user_id = $1\n\t\t\t  ORDER BY p.created_at DESC`\n\terr := r.db.Select(\u0026posts, query, userID)\n\treturn posts, err\n}\n\nfunc (r *postgresBlogPostRepository) IsSlugTaken(slug string, userID int64) (bool, error) {\n\tvar exists bool\n\tquery := `SELECT EXISTS(SELECT 1 FROM blog_posts WHERE slug = $1 AND user_id = $2)`\n\terr := r.db.Get(\u0026exists, query, slug, userID)\n\tif err != nil {\n\t\treturn false, fmt.Errorf(\"failed to check if slug is taken: %w\", err)\n\t}\n\treturn exists, nil\n}\n",
  "internal/repository/postgres/social_repository.go": "package postgres\n\nimport (\n\t\"database/sql\"\n\t\"job-app-tracker/internal/domain\"\n\t\"job-app-tracker/internal/repository\"\n\n\t\"github.com/jmoiron/sqlx\"\n)\n\n// Comment Repository\ntype postgresCommentRepository struct {\n\tdb *sqlx.DB\n}\n\nfunc NewPostgresCommentRepository(db *sqlx.DB) repository.CommentRepository {\n\treturn \u0026postgresCommentRepository{db: db}\n}\n\nfunc (r *postgresCommentRepository) Create(comment *domain.Comment) error {\n\tquery := `INSERT INTO comments (post_id, user_id, parent_comment_id, content_md, content_html, depth_level)\n              VALUES ($1, $2, $3, $4, $5, $6)\n              RETURNING id, created_at, updated_at`\n\terr := r.db.QueryRow(\n\t\tquery,\n\t\tcomment.PostID, comment.UserID, comment.ParentCommentID, // Formatted arguments\n\t\tcomment.ContentMD, comment.ContentHTML, comment.DepthLevel,\n\t).Scan(\u0026comment.ID, \u0026comment.CreatedAt, \u0026comment.UpdatedAt)\n\treturn err\n}\n\nfunc (r *postgresCommentRepository) GetByID(id int64) (*domain.Comment, error) {\n\tvar comment domain.Comment\n\tquery := `SELECT * FROM comments WHERE id = $1` // Changed to SELECT *\n\terr := r.db.Get(\u0026comment, query, id)\n\tif err == sql.ErrNoRows {\n\t\treturn nil, nil\n\t}\n\treturn \u0026comment, err\n}\n\nfunc (r *postgresCommentRepository) GetForPost(postID int64) ([]*domain.Comment, error) {\n\tvar comments []*domain.Comment\n\tquery := `SELECT c.*, u.username FROM comments c\n              JOIN users u ON c.user_id = u.id\n              WHERE c.post_id = $1\n              ORDER BY c.created_at ASC` // Formatted query\n\terr := r.db.Select(\u0026comments, query, postID)\n\treturn comments, err\n}\n\n// Like Repository\ntype postgresLikeRepository struct {\n\tdb *sqlx.DB\n}\n\nfunc NewPostgresLikeRepository(db *sqlx.DB) repository.LikeRepository {\n\treturn \u0026postgresLikeRepository{db: db}\n}\n\nfunc (r *postgresLikeRepository) Create(like *domain.Like) error {\n\tquery := `INSERT INTO likes (user_id, content_type, content_id)\n              VALUES ($1, $2, $3)\n              RETURNING id, created_at` // Formatted query\n\treturn r.db.QueryRow(query, like.UserID, like.ContentType, like.ContentID).Scan(\u0026like.ID, \u0026like.CreatedAt)\n}\n\nfunc (r *postgresLikeRepository) Delete(userID int64, contentType domain.ContentType, contentID int64) error {\n\tquery := `DELETE FROM likes WHERE user_id = $1 AND content_type = $2 AND content_id = $3`\n\t_, err := r.db.Exec(query, userID, contentType, contentID)\n\treturn err\n}\n\nfunc (r *postgresLikeRepository) Get(userID int64, contentType domain.ContentType, contentID int64) (*domain.Like, error) {\n\tvar like domain.Like\n\tquery := `SELECT * FROM likes WHERE user_id = $1 AND content_type = $2 AND content_id = $3` // Changed to SELECT *\n\terr := r.db.Get(\u0026like, query, userID, contentType, contentID)\n\tif err == sql.ErrNoRows {\n\t\treturn nil, nil\n\t}\n\treturn \u0026like, err\n}\n\n// Follow Repository (Added from attempted)\ntype postgresFollowRepository struct {\n\tdb *sqlx.DB\n}\n\nfunc NewPostgresFollowRepository(db *sqlx.DB) repository.FollowRepository {\n\treturn \u0026postgresFollowRepository{db: db}\n}\n\nfunc (r *postgresFollowRepository) Create(follow *domain.Follow) error {\n\tquery := `INSERT INTO follows (follower_user_id, followee_user_id) VALUES ($1, $2) RETURNING id, created_at`\n\treturn r.db.QueryRow(query, follow.FollowerUserID, follow.FolloweeUserID).Scan(\u0026follow.ID, \u0026follow.CreatedAt)\n}\n\nfunc (r *postgresFollowRepository) Delete(followerID, followeeID int64) error {\n\tquery := `DELETE FROM follows WHERE follower_user_id = $1 AND followee_user_id = $2`\n\t_, err := r.db.Exec(query, followerID, followeeID)\n\treturn err\n}\n\nfunc (r *postgresFollowRepository) Exists(followerID, followeeID int64) (bool, error) {\n\tvar exists bool\n\tquery := `SELECT EXISTS(SELECT 1 FROM follows WHERE follower_user_id = $1 AND followee_user_id = $2)`\n\terr := r.db.Get(\u0026exists, query, followerID, followeeID)\n\treturn exists, err\n}\n\nfunc (r *postgresFollowRepository) GetFollowerCount(userID int64) (int, error) {\n\tvar count int\n\tquery := `SELECT COUNT(*) FROM follows WHERE followee_user_id = $1`\n\terr := r.db.Get(\u0026count, query, userID)\n\treturn count, err\n}\n\nfunc (r *postgresFollowRepository) GetFollowingCount(userID int64) (int, error) {\n\tvar count int\n\tquery := `SELECT COUNT(*) FROM follows WHERE follower_user_id = $1`\n\terr := r.db.Get(\u0026count, query, userID)\n\treturn count, err\n}\n",
  "internal/repository/postgres/user_repository.go": "package postgres\n\nimport (\n\t\"database/sql\"\n\t\"job-app-tracker/internal/domain\"\n\t\"job-app-tracker/internal/repository\"\n\n\t\"github.com/jmoiron/sqlx\"\n)\n\ntype postgresUserRepository struct {\n\tdb *sqlx.DB\n}\n\nfunc NewPostgresUserRepository(db *sqlx.DB) repository.UserRepository {\n\treturn \u0026postgresUserRepository{db: db}\n}\n\nfunc (r *postgresUserRepository) Create(user *domain.User) error {\n\tquery := `INSERT INTO users (username, email, hashed_password) VALUES ($1, $2, $3) RETURNING id, created_at, updated_at`\n\treturn r.db.QueryRow(query, user.Username, user.Email, user.HashedPassword).Scan(\u0026user.ID, \u0026user.CreatedAt, \u0026user.UpdatedAt)\n}\n\nfunc (r *postgresUserRepository) GetByEmail(email string) (*domain.User, error) {\n\tvar user domain.User\n\tquery := `SELECT id, username, email, hashed_password, bio, avatar_url, settings, created_at, updated_at FROM users WHERE email = $1`\n\terr := r.db.Get(\u0026user, query, email)\n\tif err == sql.ErrNoRows {\n\t\treturn nil, nil // Not an error, just no user found\n\t}\n\treturn \u0026user, err\n}\n\nfunc (r *postgresUserRepository) GetByUsername(username string) (*domain.User, error) {\n\tvar user domain.User\n\tquery := `SELECT id, username, email, hashed_password, bio, avatar_url, settings, created_at, updated_at FROM users WHERE username = $1`\n\terr := r.db.Get(\u0026user, query, username)\n\tif err == sql.ErrNoRows {\n\t\treturn nil, nil // Not an error, just no user found\n\t}\n\treturn \u0026user, err\n}\n\nfunc (r *postgresUserRepository) GetByID(id int64) (*domain.User, error) {\n\tvar user domain.User\n\tquery := `SELECT id, username, email, hashed_password, bio, avatar_url, settings, created_at, updated_at FROM users WHERE id = $1`\n\terr := r.db.Get(\u0026user, query, id)\n\tif err == sql.ErrNoRows {\n\t\treturn nil, nil\n\t}\n\treturn \u0026user, err\n}\n",
  "internal/usecase/application_service.go": "package usecase\n\nimport (\n\t\"fmt\"\n\t\"job-app-tracker/internal/domain\"\n\t\"job-app-tracker/internal/repository\"\n\t\"strings\"\n\t\"time\"\n)\n\ntype applicationService struct {\n\tappRepo     repository.ApplicationRepository\n\tcompanyRepo repository.CompanyRepository\n\troleRepo    repository.RoleRepository\n}\n\nfunc NewApplicationService(appRepo repository.ApplicationRepository, companyRepo repository.CompanyRepository, roleRepo repository.RoleRepository) ApplicationUseCase {\n\treturn \u0026applicationService{\n\t\tappRepo:     appRepo,\n\t\tcompanyRepo: companyRepo,\n\t\troleRepo:    roleRepo,\n\t}\n}\n\nfunc (s *applicationService) CreateApplication(userID int64, companyName, roleTitle, status, dateAppliedStr string) (*domain.Application, error) {\n\tcompany := \u0026domain.Company{\n\t\tName:           companyName,\n\t\tNormalizedName: strings.ToLower(companyName),\n\t}\n\tif err := s.companyRepo.FindOrCreate(company); err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to find or create company: %w\", err)\n\t}\n\n\trole := \u0026domain.Role{\n\t\tCompanyID: company.ID,\n\t\tTitle:     roleTitle,\n\t}\n\tif err := s.roleRepo.FindOrCreate(role); err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to find or create role: %w\", err)\n\t}\n\n\tdateApplied, err := time.Parse(\"2006-01-02\", dateAppliedStr)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"invalid date format: %w\", err)\n\t}\n\n\tapp := \u0026domain.Application{\n\t\tUserID:      userID,\n\t\tCompanyID:   company.ID,\n\t\tRoleID:      role.ID,\n\t\tDateApplied: dateApplied,\n\t\tStatus:      status,\n\t}\n\n\tif err := s.appRepo.Create(app); err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to create application: %w\", err)\n\t}\n\n\treturn app, nil\n}\n\nfunc (s *applicationService) GetApplications(userID int64, params domain.ListParams) (*domain.PaginatedApplications, error) {\n\treturn s.appRepo.GetApplications(userID, params)\n}\n\nfunc (s *applicationService) GetApplicationByID(id, userID int64) (*domain.Application, error) {\n\treturn s.appRepo.GetByID(id, userID)\n}\n\nfunc (s *applicationService) UpdateApplication(id, userID int64, companyName, roleTitle, status, dateAppliedStr string) (*domain.Application, error) {\n\tapp, err := s.appRepo.GetByID(id, userID)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\tif app == nil {\n\t\treturn nil, fmt.Errorf(\"application not found\")\n\t}\n\n\tcompany := \u0026domain.Company{\n\t\tName:           companyName,\n\t\tNormalizedName: strings.ToLower(companyName),\n\t}\n\tif err := s.companyRepo.FindOrCreate(company); err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to find or create company: %w\", err)\n\t}\n\n\trole := \u0026domain.Role{\n\t\tCompanyID: company.ID,\n\t\tTitle:     roleTitle,\n\t}\n\tif err := s.roleRepo.FindOrCreate(role); err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to find or create role: %w\", err)\n\t}\n\n\tdateApplied, err := time.Parse(\"2006-01-02\", dateAppliedStr)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"invalid date format: %w\", err)\n\t}\n\n\tapp.CompanyID = company.ID\n\tapp.RoleID = role.ID\n\tapp.Status = status\n\tapp.DateApplied = dateApplied\n\n\tif err := s.appRepo.Update(app); err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to update application: %w\", err)\n\t}\n\n\treturn app, nil\n}\n\nfunc (s *applicationService) DeleteApplication(id, userID int64) error {\n\treturn s.appRepo.Delete(id, userID)\n}\n",
  "internal/usecase/blog_service.go": "package usecase\n\nimport (\n\t\"fmt\"\n\t\"job-app-tracker/internal/domain\"\n\t\"job-app-tracker/internal/repository\"\n\t\"job-app-tracker/pkg/util\"\n\t\"strconv\"\n)\n\nconst MaxCommentDepth = 5\n\ntype blogService struct {\n\tblogRepo    repository.BlogPostRepository\n\tcommentRepo repository.CommentRepository\n\tlikeRepo    repository.LikeRepository\n}\n\nfunc NewBlogService(blogRepo repository.BlogPostRepository, commentRepo repository.CommentRepository, likeRepo repository.LikeRepository) BlogUseCase {\n\treturn \u0026blogService{\n\t\tblogRepo:    blogRepo,\n\t\tcommentRepo: commentRepo,\n\t\tlikeRepo:    likeRepo,\n\t}\n}\n\nfunc (s *blogService) CreatePost(userID int64, title, contentMd, contentHtml string, isPublic bool) (*domain.BlogPost, error) {\n\tslug := util.Slugify(title)\n\n\t// Ensure slug is unique for the user\n\tisTaken, err := s.blogRepo.IsSlugTaken(slug, userID)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to check slug uniqueness: %w\", err)\n\t}\n\tif isTaken {\n\t\t// Append a suffix to make it unique\n\t\ti := 1\n\t\tfor {\n\t\t\tnewSlug := fmt.Sprintf(\"%s-%d\", slug, i)\n\t\t\tisTaken, err = s.blogRepo.IsSlugTaken(newSlug, userID)\n\t\t\tif err != nil {\n\t\t\t\treturn nil, fmt.Errorf(\"failed to check slug uniqueness: %w\", err)\n\t\t\t}\n\t\t\tif !isTaken {\n\t\t\t\tslug = newSlug\n\t\t\t\tbreak\n\t\t\t}\n\t\t\ti++\n\t\t}\n\t}\n\n\t// Create an excerpt\n\texcerpt := contentMd\n\tif len(excerpt) \u003e 150 {\n\t\texcerpt = excerpt[:150] + \"...\"\n\t}\n\n\tpost := \u0026domain.BlogPost{\n\t\tUserID:      userID,\n\t\tTitle:       title,\n\t\tSlug:        slug,\n\t\tContentMD:   contentMd,\n\t\tContentHTML: contentHtml,\n\t\tExcerpt:     excerpt,\n\t\tIsPublic:    isPublic,\n\t}\n\n\tif err := s.blogRepo.Create(post); err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to create post: %w\", err)\n\t}\n\n\treturn post, nil\n}\n\nfunc (s *blogService) GetPublicPost(username, slug string) (*domain.BlogPost, error) {\n\tpost, err := s.blogRepo.GetBySlugAndUser(slug, username)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\tif post != nil \u0026\u0026 !post.IsPublic {\n\t\treturn nil, nil // Not found if not public\n\t}\n\treturn post, nil\n}\n\nfunc (s *blogService) GetPublicPosts(params domain.ListParams) (*domain.PaginatedBlogPosts, error) {\n\treturn s.blogRepo.GetPublicPosts(params)\n}\n\nfunc (s *blogService) AddComment(postID, userID int64, parentCommentID *int64, contentMd, contentHtml string) (*domain.Comment, error) {\n\tcomment := \u0026domain.Comment{\n\t\tPostID:      postID,\n\t\tUserID:      userID,\n\t\tContentMD:   contentMd,\n\t\tContentHTML: contentHtml,\n\t\tDepthLevel:  0,\n\t}\n\n\tif parentCommentID != nil {\n\t\tparent, err := s.commentRepo.GetByID(*parentCommentID)\n\t\tif err != nil {\n\t\t\treturn nil, fmt.Errorf(\"failed to get parent comment: %w\", err)\n\t\t}\n\t\tif parent == nil {\n\t\t\treturn nil, fmt.Errorf(\"parent comment not found\")\n\t\t}\n\t\tif parent.DepthLevel \u003e= MaxCommentDepth {\n\t\t\treturn nil, fmt.Errorf(\"maximum comment depth reached\")\n\t\t}\n\t\tcomment.ParentCommentID.Int64 = *parentCommentID\n\t\tcomment.ParentCommentID.Valid = true\n\t\tcomment.DepthLevel = parent.DepthLevel + 1\n\t}\n\n\tif err := s.commentRepo.Create(comment); err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to create comment: %w\", err)\n\t}\n\n\treturn comment, nil\n}\n\nfunc (s *blogService) GetCommentsForPost(postID int64) ([]*domain.Comment, error) {\n\tflatComments, err := s.commentRepo.GetForPost(postID)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\n\tcommentMap := make(map[int64]*domain.Comment)\n\tvar rootComments []*domain.Comment\n\n\tfor i := range flatComments {\n\t\tc := flatComments[i]\n\t\tcommentMap[c.ID] = \u0026c\n\t}\n\n\tfor _, c := range flatComments {\n\t\tcomment := c\n\t\tif comment.ParentCommentID.Valid {\n\t\t\tparent, ok := commentMap[comment.ParentCommentID.Int64]\n\t\t\tif ok {\n\t\t\t\tparent.Replies = append(parent.Replies, \u0026comment)\n\t\t\t}\n\t\t} else {\n\t\t\trootComments = append(rootComments, \u0026comment)\n\t\t}\n\t}\n\n\treturn rootComments, nil\n}\n\nfunc (s *blogService) ToggleLike(userID int64, contentType domain.ContentType, contentID int64) (bool, error) {\n\texistingLike, err := s.likeRepo.Get(userID, contentType, contentID)\n\tif err != nil {\n\t\treturn false, fmt.Errorf(\"failed to check for existing like: %w\", err)\n\t}\n\n\tif existingLike != nil {\n\t\t// Unlike\n\t\tif err := s.likeRepo.Delete(userID, contentType, contentID); err != nil {\n\t\t\treturn false, fmt.Errorf(\"failed to delete like: %w\", err)\n\t\t}\n\t\treturn false, nil\n\t}\n\n\t// Like\n\tlike := \u0026domain.Like{\n\t\tUserID:      userID,\n\t\tContentType: contentType,\n\t\tContentID:   contentID,\n\t}\n\tif err := s.likeRepo.Create(like); err != nil {\n\t\treturn false, fmt.Errorf(\"failed to create like: %w\", err)\n\t}\n\treturn true, nil\n}\n",
  "internal/usecase/interfaces.go": "package usecase\n\nimport \"job-app-tracker/internal/domain\"\n\ntype UserUseCase interface {\n\tRegister(username, email, password string) (*domain.User, error)\n\tLogin(email, password string) (*domain.User, string, error)\n\tGetProfile(username string, viewerID int64) (*UserProfile, error)\n\tFollowUser(followerID int64, followeeUsername string) error\n\tUnfollowUser(followerID int64, followeeUsername string) error\n}\n\ntype ApplicationUseCase interface {\n\tCreateApplication(userID int64, companyName, roleTitle, status, dateAppliedStr string) (*domain.Application, error)\n\tGetApplications(userID int64, params domain.ListParams) (*domain.PaginatedApplications, error)\n\tGetApplicationByID(id, userID int64) (*domain.Application, error)\n\tUpdateApplication(id, userID int64, companyName, roleTitle, status, dateAppliedStr string) (*domain.Application, error)\n\tDeleteApplication(id, userID int64) error\n}\n\ntype BlogUseCase interface {\n\tCreatePost(userID int64, title, contentMd, contentHtml string, isPublic bool) (*domain.BlogPost, error)\n\tGetPublicPost(username, slug string) (*domain.BlogPost, error)\n\tGetPublicPosts(params domain.ListParams) (*domain.PaginatedBlogPosts, error)\n\tAddComment(postID, userID int64, parentCommentID *int64, contentMd, contentHtml string) (*domain.Comment, error)\n\tGetCommentsForPost(postID int64) ([]*domain.Comment, error)\n\tToggleLike(userID int64, contentType domain.ContentType, contentID int64) (bool, error)\n}\n\n// UserProfile is a DTO for the user profile view\ntype UserProfile struct {\n\tUser           *domain.User         `json:\"user\"`\n\tPosts          []domain.BlogPost    `json:\"posts\"`\n\tIsFollowing    bool                 `json:\"isFollowing\"`\n\tFollowerCount  int                  `json:\"followerCount\"`\n\tFollowingCount int                  `json:\"followingCount\"`\n}",
  "internal/usecase/user_service.go": "package usecase\n\nimport (\n\t\"errors\"\n\t\"fmt\" // Added from attempted\n\n\t\"job-app-tracker/internal/domain\"\n\t\"job-app-tracker/internal/repository\"\n\t\"job-app-tracker/pkg/util\"\n)\n\ntype userService struct {\n\tuserRepo   repository.UserRepository\n\tblogRepo   repository.BlogPostRepository   // Added from attempted\n\tfollowRepo repository.FollowRepository // Added from attempted\n}\n\nfunc NewUserService(userRepo repository.UserRepository, blogRepo repository.BlogPostRepository, followRepo repository.FollowRepository) UserUseCase { // Updated signature\n\treturn \u0026userService{\n\t\tuserRepo:   userRepo,\n\t\tblogRepo:   blogRepo,\n\t\tfollowRepo: followRepo,\n\t}\n}\n\nfunc (s *userService) Register(username, email, password string) (*domain.User, error) {\n\t// Basic validation\n\tif username == \"\" || email == \"\" || password == \"\" {\n\t\treturn nil, errors.New(\"username, email, and password are required\")\n\t}\n\n\t// Check if user already exists\n\texistingUser, err := s.userRepo.GetByEmail(email)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"error checking for existing user by email: %w\", err) // Added error wrapping\n\t}\n\tif existingUser != nil {\n\t\treturn nil, errors.New(\"user with this email already exists\")\n\t}\n\n\texistingUser, err = s.userRepo.GetByUsername(username)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"error checking for existing user by username: %w\", err) // Added error wrapping\n\t}\n\tif existingUser != nil {\n\t\treturn nil, errors.New(\"username is already taken\")\n\t}\n\n\t// Hash password\n\thashedPassword, err := util.HashPassword(password)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to hash password: %w\", err) // Added error wrapping\n\t}\n\n\t// Create user\n\tuser := \u0026domain.User{\n\t\tUsername:       username,\n\t\tEmail:          email,\n\t\tHashedPassword: hashedPassword,\n\t}\n\n\tif err := s.userRepo.Create(user); err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to create user: %w\", err) // Added error wrapping\n\t}\n\n\treturn user, nil\n}\n\nfunc (s *userService) Login(email, password string) (*domain.User, string, error) { // Updated signature\n\tuser, err := s.userRepo.GetByEmail(email)\n\tif err != nil {\n\t\treturn nil, \"\", fmt.Errorf(\"error retrieving user: %w\", err) // Added error wrapping\n\t}\n\tif user == nil {\n\t\treturn nil, \"\", errors.New(\"invalid credentials\")\n\t}\n\n\tif !util.CheckPasswordHash(password, user.HashedPassword) {\n\t\treturn nil, \"\", errors.New(\"invalid credentials\")\n\t}\n\n\ttoken, err := util.GenerateJWT(user.ID, user.Username)\n\tif err != nil {\n\t\treturn nil, \"\", fmt.Errorf(\"failed to generate token: %w\", err) // Added error wrapping\n\t}\n\n\treturn user, token, nil // Updated return value\n}\n\nfunc (s *userService) GetProfile(username string, viewerID int64) (*UserProfile, error) { // Added from attempted\n\tuser, err := s.userRepo.GetByUsername(username)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"error getting user: %w\", err)\n\t}\n\tif user == nil {\n\t\treturn nil, errors.New(\"user not found\")\n\t}\n\n\tposts, err := s.blogRepo.GetPublicPostsByUserID(user.ID)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"error getting user posts: %w\", err)\n\t}\n\n\tfollowerCount, err := s.followRepo.GetFollowerCount(user.ID)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"error getting follower count: %w\", err)\n\t}\n\n\tfollowingCount, err := s.followRepo.GetFollowingCount(user.ID)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"error getting following count: %w\", err)\n\t}\n\n\tisFollowing := false\n\tif viewerID != 0 \u0026\u0026 viewerID != user.ID {\n\t\tisFollowing, err = s.followRepo.Exists(viewerID, user.ID)\n\t\tif err != nil {\n\t\t\treturn nil, fmt.Errorf(\"error checking follow status: %w\", err)\n\t\t}\n\t}\n\n\tuser.HashedPassword = \"\" // Sanitize user data\n\tprofile := \u0026UserProfile{\n\t\tUser:           user,\n\t\tPosts:          posts,\n\t\tIsFollowing:    isFollowing,\n\t\tFollowerCount:  followerCount,\n\t\tFollowingCount: followingCount,\n\t}\n\n\treturn profile, nil\n}\n\nfunc (s *userService) FollowUser(followerID int64, followeeUsername string) error { // Added from attempted\n\tfollowee, err := s.userRepo.GetByUsername(followeeUsername)\n\tif err != nil || followee == nil {\n\t\treturn errors.New(\"user to follow not found\")\n\t}\n\n\tif followerID == followee.ID {\n\t\treturn errors.New(\"cannot follow yourself\")\n\t}\n\n\texists, err := s.followRepo.Exists(followerID, followee.ID)\n\tif err != nil {\n\t\treturn err\n\t}\n\tif exists {\n\t\treturn nil // Already following, no error\n\t}\n\n\tfollow := \u0026domain.Follow{\n\t\tFollowerUserID: followerID,\n\t\tFolloweeUserID: followee.ID,\n\t}\n\n\treturn s.followRepo.Create(follow)\n}\n\nfunc (s *userService) UnfollowUser(followerID int64, followeeUsername string) error { // Added from attempted\n\tfollowee, err := s.userRepo.GetByUsername(followeeUsername)\n\tif err != nil || followee == nil {\n\t\treturn errors.New(\"user to unfollow not found\")\n\t}\n\n\treturn s.followRepo.Delete(followerID, followee.ID)\n}\n",
  "migrations/000001_create_users_table.up.sql": "CREATE TABLE IF NOT EXISTS users (\n    id BIGSERIAL PRIMARY KEY,\n    username VARCHAR(50) UNIQUE NOT NULL,\n    email VARCHAR(255) UNIQUE NOT NULL,\n    hashed_password VARCHAR(255) NOT NULL,\n    bio TEXT,\n    avatar_url VARCHAR(255),\n    settings JSONB,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n",
  "migrations/000002_create_application_tables.up.sql": "CREATE TABLE companies (\n    id BIGSERIAL PRIMARY KEY,\n    name VARCHAR(255) NOT NULL,\n    normalized_name VARCHAR(255) NOT NULL UNIQUE,\n    metadata JSONB\n);\n\nCREATE TABLE roles (\n    id BIGSERIAL PRIMARY KEY,\n    company_id BIGINT NOT NULL REFERENCES companies(id) ON DELETE CASCADE,\n    title VARCHAR(255) NOT NULL,\n    metadata JSONB,\n    UNIQUE(company_id, title)\n);\n\nCREATE TABLE applications (\n    id BIGSERIAL PRIMARY KEY,\n    user_id BIGINT NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    company_id BIGINT NOT NULL REFERENCES companies(id) ON DELETE CASCADE,\n    role_id BIGINT NOT NULL REFERENCES roles(id) ON DELETE CASCADE,\n    date_applied DATE NOT NULL,\n    status VARCHAR(50) NOT NULL,\n    metadata JSONB,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\nCREATE TABLE application_notes (\n    id BIGSERIAL PRIMARY KEY,\n    application_id BIGINT NOT NULL REFERENCES applications(id) ON DELETE CASCADE,\n    user_id BIGINT NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    content TEXT NOT NULL,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\nCREATE INDEX idx_applications_user_id ON applications(user_id);\nCREATE INDEX idx_applications_status ON applications(status);\nCREATE INDEX idx_application_notes_application_id ON application_notes(application_id);\n",
  "migrations/000003_create_blog_tables.up.sql": "CREATE TABLE blog_posts (\n    id BIGSERIAL PRIMARY KEY,\n    user_id BIGINT NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    title VARCHAR(255) NOT NULL,\n    slug VARCHAR(255) NOT NULL,\n    content_md TEXT NOT NULL,\n    content_html TEXT NOT NULL,\n    excerpt TEXT,\n    is_public BOOLEAN NOT NULL DEFAULT FALSE, -- Default to draft\n    seo_meta_title VARCHAR(255),\n    seo_meta_description VARCHAR(255),\n    tags TEXT[],\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    UNIQUE(user_id, slug)\n);\n\nCREATE INDEX idx_blog_posts_user_id ON blog_posts(user_id);\nCREATE INDEX idx_blog_posts_slug ON blog_posts(slug);\nCREATE INDEX idx_blog_posts_is_public ON blog_posts(is_public);\n",
  "migrations/000004_create_social_tables.up.sql": "CREATE TYPE content_type AS ENUM ('post', 'comment');\n\nCREATE TABLE comments (\n    id BIGSERIAL PRIMARY KEY,\n    post_id BIGINT NOT NULL REFERENCES blog_posts(id) ON DELETE CASCADE,\n    user_id BIGINT NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    parent_comment_id BIGINT REFERENCES comments(id) ON DELETE CASCADE,\n    content_md TEXT NOT NULL,\n    content_html TEXT NOT NULL,\n    depth_level INT NOT NULL DEFAULT 0,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\nCREATE TABLE likes (\n    id BIGSERIAL PRIMARY KEY,\n    user_id BIGINT NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    content_type content_type NOT NULL,\n    content_id BIGINT NOT NULL,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    UNIQUE(user_id, content_type, content_id)\n);\n\nCREATE TABLE follows (\n    id BIGSERIAL PRIMARY KEY,\n    follower_user_id BIGINT NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    followee_user_id BIGINT NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    UNIQUE(follower_user_id, followee_user_id)\n);\n\nCREATE INDEX idx_comments_post_id ON comments(post_id);\nCREATE INDEX idx_comments_parent_comment_id ON comments(parent_comment_id);\nCREATE INDEX idx_likes_content ON likes(content_type, content_id);\n",
  "pkg/util/hash.go": "package util\n\nimport \"golang.org/x/crypto/bcrypt\"\n\n// HashPassword generates a bcrypt hash of the password.\nfunc HashPassword(password string) (string, error) {\n\tbytes, err := bcrypt.GenerateFromPassword([]byte(password), 14)\n\treturn string(bytes), err\n}\n\n// CheckPasswordHash compares a password with its hash.\nfunc CheckPasswordHash(password, hash string) bool {\n\terr := bcrypt.CompareHashAndPassword([]byte(hash), []byte(password))\n\treturn err == nil\n}\n",
  "pkg/util/jwt.go": "package util\n\nimport (\n\t\"fmt\"\n\t\"time\"\n\n\t\"github.com/golang-jwt/jwt/v5\"\n)\n\nvar jwtSecret = []byte(\"a_very_secret_key_that_should_be_in_env\") // TODO: Move to config\n\ntype Claims struct {\n\tUserID   int64  `json:\"user_id\"`\n\tUsername string `json:\"username\"`\n\tjwt.RegisteredClaims\n}\n\nfunc GenerateJWT(userID int64, username string) (string, error) {\n\texpirationTime := time.Now().Add(24 * time.Hour)\n\tclaims := \u0026Claims{\n\t\tUserID:   userID,\n\t\tUsername: username,\n\t\tRegisteredClaims: jwt.RegisteredClaims{\n\t\t\tExpiresAt: jwt.NewNumericDate(expirationTime),\n\t\t},\n\t}\n\n\ttoken := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)\n\treturn token.SignedString(jwtSecret)\n}\n\nfunc ValidateJWT(tokenStr string) (*Claims, error) {\n\tclaims := \u0026Claims{}\n\ttoken, err := jwt.ParseWithClaims(tokenStr, claims, func(token *jwt.Token) (interface{}, error) {\n\t\treturn jwtSecret, nil\n\t})\n\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\n\tif !token.Valid {\n\t\treturn nil, fmt.Errorf(\"invalid token\")\n\t}\n\n\treturn claims, nil\n}\n",
  "pkg/util/slugify.go": "package util\n\nimport (\n\t\"regexp\"\n\t\"strings\"\n)\n\nvar (\n\tnonAlphaNumRegex = regexp.MustCompile(`[^a-z0-9]+`)\n\tdashRegex        = regexp.MustCompile(`-{2,}`)\n)\n\nfunc Slugify(s string) string {\n\ts = strings.ToLower(s)\n\ts = nonAlphaNumRegex.ReplaceAllString(s, \"-\")\n\ts = dashRegex.ReplaceAllString(s, \"-\")\n\ts = strings.Trim(s, \"-\")\n\treturn s\n}\n"
}